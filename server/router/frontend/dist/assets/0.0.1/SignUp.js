import{o as w,u as j,a as N,b as y,w as c,j as e,I as m,B as v,L as S,G as C,U as b,N as U,O as L,d as k,i as P,n as B}from"./index.js";import{r as u}from"./leaflet-vendor.js";import{A as F}from"./AuthFooter.js";import"./mermaid-vendor.js";import"./utils-vendor.js";import"./katex-vendor.js";import"./ThemeSelect.js";const A=w(()=>{const t=j(),d=N(),a=y(!1),[r,f]=u.useState(""),[l,x]=u.useState(""),o=c.state.generalSetting,p=s=>{const n=s.target.value;f(n)},h=s=>{const n=s.target.value;x(n)},g=s=>{s.preventDefault(),i()},i=async()=>{if(!(r===""||l==="")&&!a.isLoading){try{a.setLoading();const s=b.fromPartial({username:r,password:l,role:U.USER});await L.createUser({user:s}),await k.createSession({passwordCredentials:{username:r,password:l}}),await P(),d("/")}catch(s){console.error(s),B.error(s.details||"Sign up failed")}a.setFinish()}};return e.jsxs("div",{className:"py-4 sm:py-8 w-80 max-w-full min-h-svh mx-auto flex flex-col justify-start items-center",children:[e.jsxs("div",{className:"w-full py-4 grow flex flex-col justify-center items-center",children:[e.jsxs("div",{className:"w-full flex flex-row justify-center items-center mb-6",children:[e.jsx("img",{className:"h-14 w-auto rounded-full shadow",src:o.customProfile?.logoUrl||"/logo.webp",alt:""}),e.jsx("p",{className:"ml-2 text-5xl text-foreground opacity-80",children:o.customProfile?.title||"Memos"})]}),o.disallowUserRegistration?e.jsx("p",{className:"w-full text-2xl mt-2 text-muted-foreground",children:"Sign up is not allowed."}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"w-full text-2xl mt-2 text-muted-foreground",children:t("auth.create-your-account")}),e.jsxs("form",{className:"w-full mt-2",onSubmit:g,children:[e.jsxs("div",{className:"flex flex-col justify-start items-start w-full gap-4",children:[e.jsxs("div",{className:"w-full flex flex-col justify-start items-start",children:[e.jsx("span",{className:"leading-8 text-muted-foreground",children:t("common.username")}),e.jsx(m,{className:"w-full bg-background h-10",type:"text",readOnly:a.isLoading,placeholder:t("common.username"),value:r,autoComplete:"username",autoCapitalize:"off",spellCheck:!1,onChange:p,required:!0})]}),e.jsxs("div",{className:"w-full flex flex-col justify-start items-start",children:[e.jsx("span",{className:"leading-8 text-muted-foreground",children:t("common.password")}),e.jsx(m,{className:"w-full bg-background h-10",type:"password",readOnly:a.isLoading,placeholder:t("common.password"),value:l,autoComplete:"password",autoCapitalize:"off",spellCheck:!1,onChange:h,required:!0})]})]}),e.jsx("div",{className:"flex flex-row justify-end items-center w-full mt-6",children:e.jsxs(v,{type:"submit",className:"w-full h-10",disabled:a.isLoading,onClick:i,children:[t("common.sign-up"),a.isLoading&&e.jsx(S,{className:"w-5 h-auto ml-2 animate-spin opacity-60"})]})})]})]}),c.state.profile.owner?e.jsxs("p",{className:"w-full mt-4 text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:t("auth.sign-in-tip")}),e.jsx(C,{to:"/auth",className:"cursor-pointer ml-2 text-primary hover:underline",viewTransition:!0,children:t("common.sign-in")})]}):e.jsx("p",{className:"w-full mt-4 text-sm font-medium text-muted-foreground",children:t("auth.host-tip")})]}),e.jsx(F,{})]})});export{A as default};
