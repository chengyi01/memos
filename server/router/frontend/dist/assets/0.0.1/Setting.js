import { p as createLucideIcon, aa as createRovingFocusGroupScope, ab as useDirection, ac as useControllableState, j as jsxRuntimeExports, ad as createContextScope, ae as Root, af as Primitive, ag as useComposedRefs, ah as Item, ai as composeEventHandlers, aj as Presence, ak as usePrevious, al as useSize, c as cn, u as useTranslate, U as User$1, b as useLoading, am as Dialog, an as DialogContent, ao as DialogHeader, ap as DialogTitle, aq as Label, I as Input, N as User_Role, ar as DialogFooter, B as Button, e as c, O as userServiceClient, o as observer, f as useCurrentUser, as as useDialog, V as userStore, at as Plus, S as State, au as DropdownMenu, av as DropdownMenuTrigger, aw as EllipsisVertical, ax as DropdownMenuContent, ay as DropdownMenuItem, az as Slot, aA as cva, w as workspaceStore, aB as Switch, aC as X, aD as Check, aE as WorkspaceSetting_MemoRelatedSetting, aF as workspaceSettingNamePrefix, aG as WorkspaceSetting_Key, W as UserAvatar, aH as Textarea, aI as convertFileToBase64, T as TooltipProvider, z as Tooltip, C as TooltipTrigger, F as TooltipContent, D as Trash, X as copy, aJ as PenLine, a4 as Select, a5 as SelectTrigger, a6 as SelectValue, a7 as SelectContent, a8 as SelectItem, G as Link, aK as VisibilityIcon, aL as convertVisibilityFromString, aM as Visibility, aN as convertVisibilityToString, y as Separator, aO as FieldMapping, K as IdentityProvider_Type, aP as OAuth2Config, k as absolutifyLink, H as identityProviderServiceClient, aQ as WorkspaceSetting_StorageSetting, aR as WorkspaceSetting_StorageSetting_StorageType, aS as WorkspaceSetting_StorageSetting_S3Config, aT as WorkspaceSetting_GeneralSetting_CustomProfile, aU as DialogDescription, aV as WorkspaceSetting_GeneralSetting, l as useResponsiveWidth, aW as useLocation, n as MobileHeader, aX as Library, aY as Settings2, aZ as Users } from "./index.js";
import { r as reactExports } from "./leaflet-vendor.js";
import { s as sortBy, J as isEqual, K as uniq } from "./utils-vendor.js";
import { E as ExternalLink } from "./external-link.js";
import { L as LocaleSelect, A as AppearanceSelect } from "./LocaleSelect.js";
import "./mermaid-vendor.js";
import "./katex-vendor.js";
/**
 * @license lucide-react v0.486.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const __iconNode$b = [
  ["circle", { cx: "12", cy: "12", r: "10", key: "1mglay" }],
  ["path", { d: "M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3", key: "1u773s" }],
  ["path", { d: "M12 17h.01", key: "p32p05" }]
];
const CircleHelp = createLucideIcon("circle-help", __iconNode$b);
/**
 * @license lucide-react v0.486.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const __iconNode$a = [["circle", { cx: "12", cy: "12", r: "10", key: "1mglay" }]];
const Circle = createLucideIcon("circle", __iconNode$a);
/**
 * @license lucide-react v0.486.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const __iconNode$9 = [
  ["rect", { width: "8", height: "4", x: "8", y: "2", rx: "1", ry: "1", key: "tgr4d6" }],
  [
    "path",
    {
      d: "M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",
      key: "116196"
    }
  ]
];
const Clipboard = createLucideIcon("clipboard", __iconNode$9);
/**
 * @license lucide-react v0.486.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const __iconNode$8 = [
  ["circle", { cx: "12", cy: "12", r: "10", key: "1mglay" }],
  ["polyline", { points: "12 6 12 12 16 14", key: "68esgv" }]
];
const Clock = createLucideIcon("clock", __iconNode$8);
/**
 * @license lucide-react v0.486.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const __iconNode$7 = [
  ["path", { d: "M12 20a8 8 0 1 0 0-16 8 8 0 0 0 0 16Z", key: "sobvz5" }],
  ["path", { d: "M12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z", key: "11i496" }],
  ["path", { d: "M12 2v2", key: "tus03m" }],
  ["path", { d: "M12 22v-2", key: "1osdcq" }],
  ["path", { d: "m17 20.66-1-1.73", key: "eq3orb" }],
  ["path", { d: "M11 10.27 7 3.34", key: "16pf9h" }],
  ["path", { d: "m20.66 17-1.73-1", key: "sg0v6f" }],
  ["path", { d: "m3.34 7 1.73 1", key: "1ulond" }],
  ["path", { d: "M14 12h8", key: "4f43i9" }],
  ["path", { d: "M2 12h2", key: "1t8f8n" }],
  ["path", { d: "m20.66 7-1.73 1", key: "1ow05n" }],
  ["path", { d: "m3.34 17 1.73-1", key: "nuk764" }],
  ["path", { d: "m17 3.34-1 1.73", key: "2wel8s" }],
  ["path", { d: "m11 13.73-4 6.93", key: "794ttg" }]
];
const Cog = createLucideIcon("cog", __iconNode$7);
/**
 * @license lucide-react v0.486.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const __iconNode$6 = [
  ["ellipse", { cx: "12", cy: "5", rx: "9", ry: "3", key: "msslwz" }],
  ["path", { d: "M3 5V19A9 3 0 0 0 21 19V5", key: "1wlel7" }],
  ["path", { d: "M3 12A9 3 0 0 0 21 12", key: "mv7ke4" }]
];
const Database = createLucideIcon("database", __iconNode$6);
/**
 * @license lucide-react v0.486.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const __iconNode$5 = [
  ["path", { d: "m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4", key: "g0fldk" }],
  ["path", { d: "m21 2-9.6 9.6", key: "1j0ho8" }],
  ["circle", { cx: "7.5", cy: "15.5", r: "5.5", key: "yqb3hr" }]
];
const Key = createLucideIcon("key", __iconNode$5);
/**
 * @license lucide-react v0.486.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const __iconNode$4 = [
  ["rect", { width: "20", height: "14", x: "2", y: "3", rx: "2", key: "48i651" }],
  ["line", { x1: "8", x2: "16", y1: "21", y2: "21", key: "1svkeh" }],
  ["line", { x1: "12", x2: "12", y1: "17", y2: "21", key: "vw1qmm" }]
];
const Monitor = createLucideIcon("monitor", __iconNode$4);
/**
 * @license lucide-react v0.486.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const __iconNode$3 = [
  ["rect", { width: "14", height: "20", x: "5", y: "2", rx: "2", ry: "2", key: "1yt0o3" }],
  ["path", { d: "M12 18h.01", key: "mhygvu" }]
];
const Smartphone = createLucideIcon("smartphone", __iconNode$3);
/**
 * @license lucide-react v0.486.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const __iconNode$2 = [
  ["rect", { width: "16", height: "20", x: "4", y: "2", rx: "2", ry: "2", key: "76otgf" }],
  ["line", { x1: "12", x2: "12.01", y1: "18", y2: "18", key: "1dp563" }]
];
const Tablet = createLucideIcon("tablet", __iconNode$2);
/**
 * @license lucide-react v0.486.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const __iconNode$1 = [
  ["path", { d: "M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2", key: "975kel" }],
  ["circle", { cx: "12", cy: "7", r: "4", key: "17ys0d" }]
];
const User = createLucideIcon("user", __iconNode$1);
/**
 * @license lucide-react v0.486.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const __iconNode = [
  ["path", { d: "M12 20h.01", key: "zekei9" }],
  ["path", { d: "M2 8.82a15 15 0 0 1 20 0", key: "dnpr2z" }],
  ["path", { d: "M5 12.859a10 10 0 0 1 14 0", key: "1x1e6c" }],
  ["path", { d: "M8.5 16.429a5 5 0 0 1 7 0", key: "1bycff" }]
];
const Wifi = createLucideIcon("wifi", __iconNode);
var RADIO_NAME = "Radio";
var [createRadioContext, createRadioScope] = createContextScope(RADIO_NAME);
var [RadioProvider, useRadioContext] = createRadioContext(RADIO_NAME);
var Radio = reactExports.forwardRef(
  (props, forwardedRef) => {
    const {
      __scopeRadio,
      name,
      checked = false,
      required,
      disabled,
      value = "on",
      onCheck,
      form,
      ...radioProps
    } = props;
    const [button, setButton] = reactExports.useState(null);
    const composedRefs = useComposedRefs(forwardedRef, (node) => setButton(node));
    const hasConsumerStoppedPropagationRef = reactExports.useRef(false);
    const isFormControl = button ? form || !!button.closest("form") : true;
    return /* @__PURE__ */ jsxRuntimeExports.jsxs(RadioProvider, { scope: __scopeRadio, checked, disabled, children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx(
        Primitive.button,
        {
          type: "button",
          role: "radio",
          "aria-checked": checked,
          "data-state": getState(checked),
          "data-disabled": disabled ? "" : void 0,
          disabled,
          value,
          ...radioProps,
          ref: composedRefs,
          onClick: composeEventHandlers(props.onClick, (event) => {
            if (!checked) onCheck?.();
            if (isFormControl) {
              hasConsumerStoppedPropagationRef.current = event.isPropagationStopped();
              if (!hasConsumerStoppedPropagationRef.current) event.stopPropagation();
            }
          })
        }
      ),
      isFormControl && /* @__PURE__ */ jsxRuntimeExports.jsx(
        RadioBubbleInput,
        {
          control: button,
          bubbles: !hasConsumerStoppedPropagationRef.current,
          name,
          value,
          checked,
          required,
          disabled,
          form,
          style: { transform: "translateX(-100%)" }
        }
      )
    ] });
  }
);
Radio.displayName = RADIO_NAME;
var INDICATOR_NAME = "RadioIndicator";
var RadioIndicator = reactExports.forwardRef(
  (props, forwardedRef) => {
    const { __scopeRadio, forceMount, ...indicatorProps } = props;
    const context = useRadioContext(INDICATOR_NAME, __scopeRadio);
    return /* @__PURE__ */ jsxRuntimeExports.jsx(Presence, { present: forceMount || context.checked, children: /* @__PURE__ */ jsxRuntimeExports.jsx(
      Primitive.span,
      {
        "data-state": getState(context.checked),
        "data-disabled": context.disabled ? "" : void 0,
        ...indicatorProps,
        ref: forwardedRef
      }
    ) });
  }
);
RadioIndicator.displayName = INDICATOR_NAME;
var BUBBLE_INPUT_NAME = "RadioBubbleInput";
var RadioBubbleInput = reactExports.forwardRef(
  ({
    __scopeRadio,
    control,
    checked,
    bubbles = true,
    ...props
  }, forwardedRef) => {
    const ref = reactExports.useRef(null);
    const composedRefs = useComposedRefs(ref, forwardedRef);
    const prevChecked = usePrevious(checked);
    const controlSize = useSize(control);
    reactExports.useEffect(() => {
      const input = ref.current;
      if (!input) return;
      const inputProto = window.HTMLInputElement.prototype;
      const descriptor = Object.getOwnPropertyDescriptor(
        inputProto,
        "checked"
      );
      const setChecked = descriptor.set;
      if (prevChecked !== checked && setChecked) {
        const event = new Event("click", { bubbles });
        setChecked.call(input, checked);
        input.dispatchEvent(event);
      }
    }, [prevChecked, checked, bubbles]);
    return /* @__PURE__ */ jsxRuntimeExports.jsx(
      Primitive.input,
      {
        type: "radio",
        "aria-hidden": true,
        defaultChecked: checked,
        ...props,
        tabIndex: -1,
        ref: composedRefs,
        style: {
          ...props.style,
          ...controlSize,
          position: "absolute",
          pointerEvents: "none",
          opacity: 0,
          margin: 0
        }
      }
    );
  }
);
RadioBubbleInput.displayName = BUBBLE_INPUT_NAME;
function getState(checked) {
  return checked ? "checked" : "unchecked";
}
var ARROW_KEYS = ["ArrowUp", "ArrowDown", "ArrowLeft", "ArrowRight"];
var RADIO_GROUP_NAME = "RadioGroup";
var [createRadioGroupContext, createRadioGroupScope] = createContextScope(RADIO_GROUP_NAME, [
  createRovingFocusGroupScope,
  createRadioScope
]);
var useRovingFocusGroupScope = createRovingFocusGroupScope();
var useRadioScope = createRadioScope();
var [RadioGroupProvider, useRadioGroupContext] = createRadioGroupContext(RADIO_GROUP_NAME);
var RadioGroup$1 = reactExports.forwardRef(
  (props, forwardedRef) => {
    const {
      __scopeRadioGroup,
      name,
      defaultValue,
      value: valueProp,
      required = false,
      disabled = false,
      orientation,
      dir,
      loop = true,
      onValueChange,
      ...groupProps
    } = props;
    const rovingFocusGroupScope = useRovingFocusGroupScope(__scopeRadioGroup);
    const direction = useDirection(dir);
    const [value, setValue] = useControllableState({
      prop: valueProp,
      defaultProp: defaultValue ?? null,
      onChange: onValueChange,
      caller: RADIO_GROUP_NAME
    });
    return /* @__PURE__ */ jsxRuntimeExports.jsx(
      RadioGroupProvider,
      {
        scope: __scopeRadioGroup,
        name,
        required,
        disabled,
        value,
        onValueChange: setValue,
        children: /* @__PURE__ */ jsxRuntimeExports.jsx(
          Root,
          {
            asChild: true,
            ...rovingFocusGroupScope,
            orientation,
            dir: direction,
            loop,
            children: /* @__PURE__ */ jsxRuntimeExports.jsx(
              Primitive.div,
              {
                role: "radiogroup",
                "aria-required": required,
                "aria-orientation": orientation,
                "data-disabled": disabled ? "" : void 0,
                dir: direction,
                ...groupProps,
                ref: forwardedRef
              }
            )
          }
        )
      }
    );
  }
);
RadioGroup$1.displayName = RADIO_GROUP_NAME;
var ITEM_NAME = "RadioGroupItem";
var RadioGroupItem$1 = reactExports.forwardRef(
  (props, forwardedRef) => {
    const { __scopeRadioGroup, disabled, ...itemProps } = props;
    const context = useRadioGroupContext(ITEM_NAME, __scopeRadioGroup);
    const isDisabled = context.disabled || disabled;
    const rovingFocusGroupScope = useRovingFocusGroupScope(__scopeRadioGroup);
    const radioScope = useRadioScope(__scopeRadioGroup);
    const ref = reactExports.useRef(null);
    const composedRefs = useComposedRefs(forwardedRef, ref);
    const checked = context.value === itemProps.value;
    const isArrowKeyPressedRef = reactExports.useRef(false);
    reactExports.useEffect(() => {
      const handleKeyDown = (event) => {
        if (ARROW_KEYS.includes(event.key)) {
          isArrowKeyPressedRef.current = true;
        }
      };
      const handleKeyUp = () => isArrowKeyPressedRef.current = false;
      document.addEventListener("keydown", handleKeyDown);
      document.addEventListener("keyup", handleKeyUp);
      return () => {
        document.removeEventListener("keydown", handleKeyDown);
        document.removeEventListener("keyup", handleKeyUp);
      };
    }, []);
    return /* @__PURE__ */ jsxRuntimeExports.jsx(
      Item,
      {
        asChild: true,
        ...rovingFocusGroupScope,
        focusable: !isDisabled,
        active: checked,
        children: /* @__PURE__ */ jsxRuntimeExports.jsx(
          Radio,
          {
            disabled: isDisabled,
            required: context.required,
            checked,
            ...radioScope,
            ...itemProps,
            name: context.name,
            ref: composedRefs,
            onCheck: () => context.onValueChange(itemProps.value),
            onKeyDown: composeEventHandlers((event) => {
              if (event.key === "Enter") event.preventDefault();
            }),
            onFocus: composeEventHandlers(itemProps.onFocus, () => {
              if (isArrowKeyPressedRef.current) ref.current?.click();
            })
          }
        )
      }
    );
  }
);
RadioGroupItem$1.displayName = ITEM_NAME;
var INDICATOR_NAME2 = "RadioGroupIndicator";
var RadioGroupIndicator = reactExports.forwardRef(
  (props, forwardedRef) => {
    const { __scopeRadioGroup, ...indicatorProps } = props;
    const radioScope = useRadioScope(__scopeRadioGroup);
    return /* @__PURE__ */ jsxRuntimeExports.jsx(RadioIndicator, { ...radioScope, ...indicatorProps, ref: forwardedRef });
  }
);
RadioGroupIndicator.displayName = INDICATOR_NAME2;
var Root2 = RadioGroup$1;
var Item2 = RadioGroupItem$1;
var Indicator = RadioGroupIndicator;
function RadioGroup({ className, ...props }) {
  return /* @__PURE__ */ jsxRuntimeExports.jsx(Root2, { "data-slot": "radio-group", className: cn("grid gap-3", className), ...props });
}
function RadioGroupItem({ className, ...props }) {
  return /* @__PURE__ */ jsxRuntimeExports.jsx(
    Item2,
    {
      "data-slot": "radio-group-item",
      className: cn(
        "border-border text-primary dark:bg-input/30 aspect-square size-4 shrink-0 rounded-full border shadow-xs transition-[color,box-shadow] disabled:cursor-not-allowed disabled:opacity-50",
        className
      ),
      ...props,
      children: /* @__PURE__ */ jsxRuntimeExports.jsx(Indicator, { "data-slot": "radio-group-indicator", className: "relative flex items-center justify-center", children: /* @__PURE__ */ jsxRuntimeExports.jsx(Circle, { className: "fill-primary absolute top-1/2 left-1/2 size-2 -translate-x-1/2 -translate-y-1/2" }) })
    }
  );
}
function CreateUserDialog({ open, onOpenChange, user: initialUser, onSuccess }) {
  const t = useTranslate();
  const [user, setUser] = reactExports.useState(User$1.fromPartial({ ...initialUser }));
  const requestState = useLoading(false);
  const isCreating = !initialUser;
  reactExports.useEffect(() => {
    if (initialUser) {
      setUser(User$1.fromPartial(initialUser));
    } else {
      setUser(User$1.fromPartial({}));
    }
  }, [initialUser]);
  const setPartialUser = (state) => {
    setUser({
      ...user,
      ...state
    });
  };
  const handleConfirm = async () => {
    if (isCreating && (!user.username || !user.password)) {
      c.error("Username and password cannot be empty");
      return;
    }
    try {
      requestState.setLoading();
      if (isCreating) {
        await userServiceClient.createUser({ user });
        c.success("Create user successfully");
      } else {
        const updateMask = [];
        if (user.username !== initialUser?.username) {
          updateMask.push("username");
        }
        if (user.password) {
          updateMask.push("password");
        }
        if (user.role !== initialUser?.role) {
          updateMask.push("role");
        }
        await userServiceClient.updateUser({ user, updateMask });
        c.success("Update user successfully");
      }
      requestState.setFinish();
      onSuccess?.();
      onOpenChange(false);
    } catch (error) {
      console.error(error);
      c.error(error.details);
      requestState.setError();
    }
  };
  return /* @__PURE__ */ jsxRuntimeExports.jsx(Dialog, { open, onOpenChange, children: /* @__PURE__ */ jsxRuntimeExports.jsxs(DialogContent, { className: "max-w-md", children: [
    /* @__PURE__ */ jsxRuntimeExports.jsx(DialogHeader, { children: /* @__PURE__ */ jsxRuntimeExports.jsx(DialogTitle, { children: `${isCreating ? t("common.create") : t("common.edit")} ${t("common.user")}` }) }),
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex flex-col gap-4", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "grid gap-2", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx(Label, { htmlFor: "username", children: t("common.username") }),
        /* @__PURE__ */ jsxRuntimeExports.jsx(
          Input,
          {
            id: "username",
            type: "text",
            placeholder: t("common.username"),
            value: user.username,
            onChange: (e) => setPartialUser({
              username: e.target.value
            })
          }
        )
      ] }),
      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "grid gap-2", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx(Label, { htmlFor: "password", children: t("common.password") }),
        /* @__PURE__ */ jsxRuntimeExports.jsx(
          Input,
          {
            id: "password",
            type: "password",
            placeholder: t("common.password"),
            autoComplete: "off",
            value: user.password,
            onChange: (e) => setPartialUser({
              password: e.target.value
            })
          }
        )
      ] }),
      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "grid gap-2", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx(Label, { children: t("common.role") }),
        /* @__PURE__ */ jsxRuntimeExports.jsxs(
          RadioGroup,
          {
            value: user.role,
            onValueChange: (value) => setPartialUser({ role: value }),
            className: "flex flex-row gap-4",
            children: [
              /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center space-x-2", children: [
                /* @__PURE__ */ jsxRuntimeExports.jsx(RadioGroupItem, { value: User_Role.USER, id: "user" }),
                /* @__PURE__ */ jsxRuntimeExports.jsx(Label, { htmlFor: "user", children: t("setting.member-section.user") })
              ] }),
              /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center space-x-2", children: [
                /* @__PURE__ */ jsxRuntimeExports.jsx(RadioGroupItem, { value: User_Role.ADMIN, id: "admin" }),
                /* @__PURE__ */ jsxRuntimeExports.jsx(Label, { htmlFor: "admin", children: t("setting.member-section.admin") })
              ] })
            ]
          }
        )
      ] })
    ] }),
    /* @__PURE__ */ jsxRuntimeExports.jsxs(DialogFooter, { children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx(Button, { variant: "ghost", disabled: requestState.isLoading, onClick: () => onOpenChange(false), children: t("common.cancel") }),
      /* @__PURE__ */ jsxRuntimeExports.jsx(Button, { disabled: requestState.isLoading, onClick: handleConfirm, children: t("common.confirm") })
    ] })
  ] }) });
}
const MemberSection = observer(() => {
  const t = useTranslate();
  const currentUser = useCurrentUser();
  const [users, setUsers] = reactExports.useState([]);
  const createDialog = useDialog();
  const editDialog = useDialog();
  const [editingUser, setEditingUser] = reactExports.useState();
  const sortedUsers = sortBy(users, "id");
  reactExports.useEffect(() => {
    fetchUsers();
  }, []);
  const fetchUsers = async () => {
    const users2 = await userStore.fetchUsers();
    setUsers(users2);
  };
  const stringifyUserRole = (role) => {
    if (role === User_Role.HOST) {
      return "Host";
    } else if (role === User_Role.ADMIN) {
      return t("setting.member-section.admin");
    } else {
      return t("setting.member-section.user");
    }
  };
  const handleCreateUser = () => {
    setEditingUser(void 0);
    createDialog.open();
  };
  const handleEditUser = (user) => {
    setEditingUser(user);
    editDialog.open();
  };
  const handleArchiveUserClick = async (user) => {
    const confirmed = window.confirm(t("setting.member-section.archive-warning", { username: user.displayName }));
    if (confirmed) {
      await userServiceClient.updateUser({
        user: {
          name: user.name,
          state: State.ARCHIVED
        },
        updateMask: ["state"]
      });
      fetchUsers();
    }
  };
  const handleRestoreUserClick = async (user) => {
    await userServiceClient.updateUser({
      user: {
        name: user.name,
        state: State.NORMAL
      },
      updateMask: ["state"]
    });
    fetchUsers();
  };
  const handleDeleteUserClick = async (user) => {
    const confirmed = window.confirm(t("setting.member-section.delete-warning", { username: user.displayName }));
    if (confirmed) {
      await userStore.deleteUser(user.name);
      fetchUsers();
    }
  };
  return /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "w-full flex flex-col gap-2 pt-2 pb-4", children: [
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "w-full flex flex-row justify-between items-center", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx("p", { className: "font-medium text-muted-foreground", children: t("setting.member-section.create-a-member") }),
      /* @__PURE__ */ jsxRuntimeExports.jsxs(Button, { onClick: handleCreateUser, children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx(Plus, { className: "w-4 h-4 mr-2" }),
        t("common.create")
      ] })
    ] }),
    /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "w-full flex flex-row justify-between items-center mt-6", children: /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "title-text", children: t("setting.member-list") }) }),
    /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "w-full overflow-x-auto", children: /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "inline-block min-w-full align-middle border border-border rounded-lg", children: /* @__PURE__ */ jsxRuntimeExports.jsxs("table", { className: "min-w-full divide-y divide-border", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx("thead", { children: /* @__PURE__ */ jsxRuntimeExports.jsxs("tr", { className: "text-sm font-semibold text-left text-foreground", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx("th", { scope: "col", className: "px-3 py-2", children: t("common.username") }),
        /* @__PURE__ */ jsxRuntimeExports.jsx("th", { scope: "col", className: "px-3 py-2", children: t("common.role") }),
        /* @__PURE__ */ jsxRuntimeExports.jsx("th", { scope: "col", className: "px-3 py-2", children: t("common.nickname") }),
        /* @__PURE__ */ jsxRuntimeExports.jsx("th", { scope: "col", className: "px-3 py-2", children: t("common.email") }),
        /* @__PURE__ */ jsxRuntimeExports.jsx("th", { scope: "col", className: "relative py-2 pl-3 pr-4" })
      ] }) }),
      /* @__PURE__ */ jsxRuntimeExports.jsx("tbody", { className: "divide-y divide-border", children: sortedUsers.map((user) => /* @__PURE__ */ jsxRuntimeExports.jsxs("tr", { children: [
        /* @__PURE__ */ jsxRuntimeExports.jsxs("td", { className: "whitespace-nowrap px-3 py-2 text-sm text-muted-foreground", children: [
          user.username,
          /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "ml-1 italic", children: user.state === State.ARCHIVED && "(Archived)" })
        ] }),
        /* @__PURE__ */ jsxRuntimeExports.jsx("td", { className: "whitespace-nowrap px-3 py-2 text-sm text-muted-foreground", children: stringifyUserRole(user.role) }),
        /* @__PURE__ */ jsxRuntimeExports.jsx("td", { className: "whitespace-nowrap px-3 py-2 text-sm text-muted-foreground", children: user.displayName }),
        /* @__PURE__ */ jsxRuntimeExports.jsx("td", { className: "whitespace-nowrap px-3 py-2 text-sm text-muted-foreground", children: user.email }),
        /* @__PURE__ */ jsxRuntimeExports.jsx("td", { className: "relative whitespace-nowrap py-2 pl-3 pr-4 text-right text-sm font-medium flex justify-end", children: currentUser?.name === user.name ? /* @__PURE__ */ jsxRuntimeExports.jsx("span", { children: t("common.yourself") }) : /* @__PURE__ */ jsxRuntimeExports.jsxs(DropdownMenu, { children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx(DropdownMenuTrigger, { asChild: true, children: /* @__PURE__ */ jsxRuntimeExports.jsx(Button, { variant: "outline", children: /* @__PURE__ */ jsxRuntimeExports.jsx(EllipsisVertical, { className: "w-4 h-auto" }) }) }),
          /* @__PURE__ */ jsxRuntimeExports.jsxs(DropdownMenuContent, { align: "end", sideOffset: 2, children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx(DropdownMenuItem, { onClick: () => handleEditUser(user), children: t("common.update") }),
            user.state === State.NORMAL ? /* @__PURE__ */ jsxRuntimeExports.jsx(DropdownMenuItem, { onClick: () => handleArchiveUserClick(user), children: t("setting.member-section.archive-member") }) : /* @__PURE__ */ jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment, { children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx(DropdownMenuItem, { onClick: () => handleRestoreUserClick(user), children: t("common.restore") }),
              /* @__PURE__ */ jsxRuntimeExports.jsx(
                DropdownMenuItem,
                {
                  onClick: () => handleDeleteUserClick(user),
                  className: "text-destructive focus:text-destructive",
                  children: t("setting.member-section.delete-member")
                }
              )
            ] })
          ] })
        ] }) })
      ] }, user.name)) })
    ] }) }) }),
    /* @__PURE__ */ jsxRuntimeExports.jsx(CreateUserDialog, { open: createDialog.isOpen, onOpenChange: createDialog.setOpen, onSuccess: fetchUsers }),
    /* @__PURE__ */ jsxRuntimeExports.jsx(CreateUserDialog, { open: editDialog.isOpen, onOpenChange: editDialog.setOpen, user: editingUser, onSuccess: fetchUsers })
  ] });
});
const badgeVariants = cva(
  "inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none transition-[color,box-shadow] overflow-hidden",
  {
    variants: {
      variant: {
        default: "border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",
        secondary: "border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",
        destructive: "border-transparent bg-destructive text-destructive-foreground [a&]:hover:bg-destructive/90 dark:bg-destructive/60",
        outline: "text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"
      }
    },
    defaultVariants: {
      variant: "default"
    }
  }
);
function Badge({
  className,
  variant,
  asChild = false,
  ...props
}) {
  const Comp = asChild ? Slot : "span";
  return /* @__PURE__ */ jsxRuntimeExports.jsx(Comp, { "data-slot": "badge", className: cn(badgeVariants({ variant }), className), ...props });
}
const MemoRelatedSettings = observer(() => {
  const t = useTranslate();
  const [originalSetting, setOriginalSetting] = reactExports.useState(workspaceStore.state.memoRelatedSetting);
  const [memoRelatedSetting, setMemoRelatedSetting] = reactExports.useState(originalSetting);
  const [editingReaction, setEditingReaction] = reactExports.useState("");
  const [editingNsfwTag, setEditingNsfwTag] = reactExports.useState("");
  const updatePartialSetting = (partial) => {
    const newWorkspaceMemoRelatedSetting = WorkspaceSetting_MemoRelatedSetting.fromPartial({
      ...memoRelatedSetting,
      ...partial
    });
    setMemoRelatedSetting(newWorkspaceMemoRelatedSetting);
  };
  const upsertReaction = () => {
    if (!editingReaction) {
      return;
    }
    updatePartialSetting({ reactions: uniq([...memoRelatedSetting.reactions, editingReaction.trim()]) });
    setEditingReaction("");
  };
  const upsertNsfwTags = () => {
    if (!editingNsfwTag) {
      return;
    }
    updatePartialSetting({ nsfwTags: uniq([...memoRelatedSetting.nsfwTags, editingNsfwTag.trim()]) });
    setEditingNsfwTag("");
  };
  const updateSetting = async () => {
    if (memoRelatedSetting.reactions.length === 0) {
      c.error("Reactions must not be empty.");
      return;
    }
    try {
      await workspaceStore.upsertWorkspaceSetting({
        name: `${workspaceSettingNamePrefix}${WorkspaceSetting_Key.MEMO_RELATED}`,
        memoRelatedSetting
      });
      setOriginalSetting(memoRelatedSetting);
      c.success(t("message.update-succeed"));
    } catch (error) {
      c.error(error.details);
      console.error(error);
    }
  };
  return /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "w-full flex flex-col gap-2 pt-2 pb-4", children: [
    /* @__PURE__ */ jsxRuntimeExports.jsx("p", { className: "font-medium text-muted-foreground", children: t("setting.memo-related-settings.title") }),
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "w-full flex flex-row justify-between items-center", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx("span", { children: t("setting.system-section.disable-public-memos") }),
      /* @__PURE__ */ jsxRuntimeExports.jsx(
        Switch,
        {
          checked: memoRelatedSetting.disallowPublicVisibility,
          onCheckedChange: (checked) => updatePartialSetting({ disallowPublicVisibility: checked })
        }
      )
    ] }),
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "w-full flex flex-row justify-between items-center", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx("span", { children: t("setting.system-section.display-with-updated-time") }),
      /* @__PURE__ */ jsxRuntimeExports.jsx(
        Switch,
        {
          checked: memoRelatedSetting.displayWithUpdateTime,
          onCheckedChange: (checked) => updatePartialSetting({ displayWithUpdateTime: checked })
        }
      )
    ] }),
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "w-full flex flex-row justify-between items-center", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx("span", { children: t("setting.memo-related-settings.enable-link-preview") }),
      /* @__PURE__ */ jsxRuntimeExports.jsx(
        Switch,
        {
          checked: memoRelatedSetting.enableLinkPreview,
          onCheckedChange: (checked) => updatePartialSetting({ enableLinkPreview: checked })
        }
      )
    ] }),
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "w-full flex flex-row justify-between items-center", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx("span", { children: t("setting.system-section.enable-double-click-to-edit") }),
      /* @__PURE__ */ jsxRuntimeExports.jsx(
        Switch,
        {
          checked: memoRelatedSetting.enableDoubleClickEdit,
          onCheckedChange: (checked) => updatePartialSetting({ enableDoubleClickEdit: checked })
        }
      )
    ] }),
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "w-full flex flex-row justify-between items-center", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx("span", { children: t("setting.system-section.disable-markdown-shortcuts-in-editor") }),
      /* @__PURE__ */ jsxRuntimeExports.jsx(
        Switch,
        {
          checked: memoRelatedSetting.disableMarkdownShortcuts,
          onCheckedChange: (checked) => updatePartialSetting({ disableMarkdownShortcuts: checked })
        }
      )
    ] }),
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "w-full flex flex-row justify-between items-center", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx("span", { children: t("setting.memo-related-settings.content-lenght-limit") }),
      /* @__PURE__ */ jsxRuntimeExports.jsx(
        Input,
        {
          className: "w-24",
          type: "number",
          defaultValue: memoRelatedSetting.contentLengthLimit,
          onBlur: (event) => updatePartialSetting({ contentLengthLimit: Number(event.target.value) })
        }
      )
    ] }),
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "w-full", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "truncate", children: t("setting.memo-related-settings.reactions") }),
      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "mt-2 w-full flex flex-row flex-wrap gap-1", children: [
        memoRelatedSetting.reactions.map((reactionType) => {
          return /* @__PURE__ */ jsxRuntimeExports.jsxs(Badge, { variant: "outline", className: "flex items-center gap-1", children: [
            reactionType,
            /* @__PURE__ */ jsxRuntimeExports.jsx(
              "span",
              {
                className: "cursor-pointer text-muted-foreground hover:text-primary",
                onClick: () => updatePartialSetting({ reactions: memoRelatedSetting.reactions.filter((r) => r !== reactionType) }),
                children: /* @__PURE__ */ jsxRuntimeExports.jsx(X, { className: "w-4 h-4" })
              }
            )
          ] }, reactionType);
        }),
        /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center gap-1", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx(
            Input,
            {
              className: "w-32",
              placeholder: t("common.input"),
              value: editingReaction,
              onChange: (event) => setEditingReaction(event.target.value.trim())
            }
          ),
          /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-muted-foreground cursor-pointer hover:text-primary", onClick: () => upsertReaction(), children: /* @__PURE__ */ jsxRuntimeExports.jsx(Check, { className: "w-5 h-5" }) })
        ] })
      ] })
    ] }),
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "w-full", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "w-full flex flex-row justify-between items-center", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx("span", { children: t("setting.memo-related-settings.enable-blur-nsfw-content") }),
        /* @__PURE__ */ jsxRuntimeExports.jsx(
          Switch,
          {
            checked: memoRelatedSetting.enableBlurNsfwContent,
            onCheckedChange: (checked) => updatePartialSetting({ enableBlurNsfwContent: checked })
          }
        )
      ] }),
      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "mt-2 w-full flex flex-row flex-wrap gap-1", children: [
        memoRelatedSetting.nsfwTags.map((nsfwTag) => {
          return /* @__PURE__ */ jsxRuntimeExports.jsxs(Badge, { variant: "outline", className: "flex items-center gap-1", children: [
            nsfwTag,
            /* @__PURE__ */ jsxRuntimeExports.jsx(
              "span",
              {
                className: "cursor-pointer text-muted-foreground hover:text-primary",
                onClick: () => updatePartialSetting({ nsfwTags: memoRelatedSetting.nsfwTags.filter((r) => r !== nsfwTag) }),
                children: /* @__PURE__ */ jsxRuntimeExports.jsx(X, { className: "w-4 h-4" })
              }
            )
          ] }, nsfwTag);
        }),
        /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center gap-1", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx(
            Input,
            {
              className: "w-32",
              placeholder: t("common.input"),
              value: editingNsfwTag,
              onChange: (event) => setEditingNsfwTag(event.target.value.trim())
            }
          ),
          /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-muted-foreground cursor-pointer hover:text-primary", onClick: () => upsertNsfwTags(), children: /* @__PURE__ */ jsxRuntimeExports.jsx(Check, { className: "w-5 h-5" }) })
        ] })
      ] })
    ] }),
    /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "mt-2 w-full flex justify-end", children: /* @__PURE__ */ jsxRuntimeExports.jsx(Button, { disabled: isEqual(memoRelatedSetting, originalSetting), onClick: updateSetting, children: t("common.save") }) })
  ] });
});
function ChangeMemberPasswordDialog({ open, onOpenChange, user, onSuccess }) {
  const t = useTranslate();
  const [newPassword, setNewPassword] = reactExports.useState("");
  const [newPasswordAgain, setNewPasswordAgain] = reactExports.useState("");
  const handleCloseBtnClick = () => {
    onOpenChange(false);
  };
  const handleNewPasswordChanged = (e) => {
    const text = e.target.value;
    setNewPassword(text);
  };
  const handleNewPasswordAgainChanged = (e) => {
    const text = e.target.value;
    setNewPasswordAgain(text);
  };
  const handleSaveBtnClick = async () => {
    if (!user) return;
    if (newPassword === "" || newPasswordAgain === "") {
      c.error(t("message.fill-all"));
      return;
    }
    if (newPassword !== newPasswordAgain) {
      c.error(t("message.new-password-not-match"));
      setNewPasswordAgain("");
      return;
    }
    try {
      await userStore.updateUser(
        {
          name: user.name,
          password: newPassword
        },
        ["password"]
      );
      c(t("message.password-changed"));
      onSuccess?.();
      onOpenChange(false);
    } catch (error) {
      console.error(error);
      c.error(error.details);
    }
  };
  if (!user) return null;
  return /* @__PURE__ */ jsxRuntimeExports.jsx(Dialog, { open, onOpenChange, children: /* @__PURE__ */ jsxRuntimeExports.jsxs(DialogContent, { className: "max-w-md", children: [
    /* @__PURE__ */ jsxRuntimeExports.jsx(DialogHeader, { children: /* @__PURE__ */ jsxRuntimeExports.jsxs(DialogTitle, { children: [
      t("setting.account-section.change-password"),
      " (",
      user.displayName,
      ")"
    ] }) }),
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex flex-col gap-4", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "grid gap-2", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx(Label, { htmlFor: "newPassword", children: t("auth.new-password") }),
        /* @__PURE__ */ jsxRuntimeExports.jsx(
          Input,
          {
            id: "newPassword",
            type: "password",
            placeholder: t("auth.new-password"),
            value: newPassword,
            onChange: handleNewPasswordChanged
          }
        )
      ] }),
      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "grid gap-2", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx(Label, { htmlFor: "newPasswordAgain", children: t("auth.repeat-new-password") }),
        /* @__PURE__ */ jsxRuntimeExports.jsx(
          Input,
          {
            id: "newPasswordAgain",
            type: "password",
            placeholder: t("auth.repeat-new-password"),
            value: newPasswordAgain,
            onChange: handleNewPasswordAgainChanged
          }
        )
      ] })
    ] }),
    /* @__PURE__ */ jsxRuntimeExports.jsxs(DialogFooter, { children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx(Button, { variant: "ghost", onClick: handleCloseBtnClick, children: t("common.cancel") }),
      /* @__PURE__ */ jsxRuntimeExports.jsx(Button, { onClick: handleSaveBtnClick, children: t("common.save") })
    ] })
  ] }) });
}
function UpdateAccountDialog({ open, onOpenChange, onSuccess }) {
  const t = useTranslate();
  const currentUser = useCurrentUser();
  const [state, setState] = reactExports.useState({
    avatarUrl: currentUser.avatarUrl,
    username: currentUser.username,
    displayName: currentUser.displayName,
    email: currentUser.email,
    description: currentUser.description
  });
  const workspaceGeneralSetting = workspaceStore.state.generalSetting;
  const handleCloseBtnClick = () => {
    onOpenChange(false);
  };
  const setPartialState = (partialState) => {
    setState((state2) => {
      return {
        ...state2,
        ...partialState
      };
    });
  };
  const handleAvatarChanged = async (e) => {
    const files = e.target.files;
    if (files && files.length > 0) {
      const image = files[0];
      if (image.size > 2 * 1024 * 1024) {
        c.error("Max file size is 2MB");
        return;
      }
      try {
        const base64 = await convertFileToBase64(image);
        setPartialState({
          avatarUrl: base64
        });
      } catch (error) {
        console.error(error);
        c.error(`Failed to convert image to base64`);
      }
    }
  };
  const handleDisplayNameChanged = (e) => {
    setPartialState({
      displayName: e.target.value
    });
  };
  const handleUsernameChanged = (e) => {
    setPartialState({
      username: e.target.value
    });
  };
  const handleEmailChanged = (e) => {
    setState((state2) => {
      return {
        ...state2,
        email: e.target.value
      };
    });
  };
  const handleDescriptionChanged = (e) => {
    setState((state2) => {
      return {
        ...state2,
        description: e.target.value
      };
    });
  };
  const handleSaveBtnClick = async () => {
    if (state.username === "") {
      c.error(t("message.fill-all"));
      return;
    }
    try {
      const updateMask = [];
      if (!isEqual(currentUser.username, state.username)) {
        updateMask.push("username");
      }
      if (!isEqual(currentUser.displayName, state.displayName)) {
        updateMask.push("display_name");
      }
      if (!isEqual(currentUser.email, state.email)) {
        updateMask.push("email");
      }
      if (!isEqual(currentUser.avatarUrl, state.avatarUrl)) {
        updateMask.push("avatar_url");
      }
      if (!isEqual(currentUser.description, state.description)) {
        updateMask.push("description");
      }
      await userStore.updateUser(
        User$1.fromPartial({
          name: currentUser.name,
          username: state.username,
          displayName: state.displayName,
          email: state.email,
          avatarUrl: state.avatarUrl,
          description: state.description
        }),
        updateMask
      );
      c.success(t("message.update-succeed"));
      onSuccess?.();
      onOpenChange(false);
    } catch (error) {
      console.error(error);
      c.error(error.details);
    }
  };
  return /* @__PURE__ */ jsxRuntimeExports.jsx(Dialog, { open, onOpenChange, children: /* @__PURE__ */ jsxRuntimeExports.jsxs(DialogContent, { className: "max-w-md", children: [
    /* @__PURE__ */ jsxRuntimeExports.jsx(DialogHeader, { children: /* @__PURE__ */ jsxRuntimeExports.jsx(DialogTitle, { children: t("setting.account-section.update-information") }) }),
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex flex-col gap-4", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex flex-row items-center gap-2", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx(Label, { children: t("common.avatar") }),
        /* @__PURE__ */ jsxRuntimeExports.jsxs("label", { className: "relative cursor-pointer hover:opacity-80", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx(UserAvatar, { className: "w-10 h-10", avatarUrl: state.avatarUrl }),
          /* @__PURE__ */ jsxRuntimeExports.jsx("input", { type: "file", accept: "image/*", className: "absolute invisible w-full h-full inset-0", onChange: handleAvatarChanged })
        ] }),
        state.avatarUrl && /* @__PURE__ */ jsxRuntimeExports.jsx(
          X,
          {
            className: "w-4 h-auto cursor-pointer opacity-60 hover:opacity-80",
            onClick: () => setPartialState({
              avatarUrl: ""
            })
          }
        )
      ] }),
      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "grid gap-2", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsxs(Label, { htmlFor: "username", children: [
          t("common.username"),
          /* @__PURE__ */ jsxRuntimeExports.jsxs("span", { className: "text-sm text-muted-foreground ml-1", children: [
            "(",
            t("setting.account-section.username-note"),
            ")"
          ] })
        ] }),
        /* @__PURE__ */ jsxRuntimeExports.jsx(
          Input,
          {
            id: "username",
            value: state.username,
            onChange: handleUsernameChanged,
            disabled: workspaceGeneralSetting.disallowChangeUsername
          }
        )
      ] }),
      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "grid gap-2", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsxs(Label, { htmlFor: "displayName", children: [
          t("common.nickname"),
          /* @__PURE__ */ jsxRuntimeExports.jsxs("span", { className: "text-sm text-muted-foreground ml-1", children: [
            "(",
            t("setting.account-section.nickname-note"),
            ")"
          ] })
        ] }),
        /* @__PURE__ */ jsxRuntimeExports.jsx(
          Input,
          {
            id: "displayName",
            value: state.displayName,
            onChange: handleDisplayNameChanged,
            disabled: workspaceGeneralSetting.disallowChangeNickname
          }
        )
      ] }),
      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "grid gap-2", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsxs(Label, { htmlFor: "email", children: [
          t("common.email"),
          /* @__PURE__ */ jsxRuntimeExports.jsxs("span", { className: "text-sm text-muted-foreground ml-1", children: [
            "(",
            t("setting.account-section.email-note"),
            ")"
          ] })
        ] }),
        /* @__PURE__ */ jsxRuntimeExports.jsx(Input, { id: "email", type: "email", value: state.email, onChange: handleEmailChanged })
      ] }),
      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "grid gap-2", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx(Label, { htmlFor: "description", children: t("common.description") }),
        /* @__PURE__ */ jsxRuntimeExports.jsx(Textarea, { id: "description", rows: 2, value: state.description, onChange: handleDescriptionChanged })
      ] })
    ] }),
    /* @__PURE__ */ jsxRuntimeExports.jsxs(DialogFooter, { children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx(Button, { variant: "ghost", onClick: handleCloseBtnClick, children: t("common.cancel") }),
      /* @__PURE__ */ jsxRuntimeExports.jsx(Button, { onClick: handleSaveBtnClick, children: t("common.save") })
    ] })
  ] }) });
}
function CreateAccessTokenDialog({ open, onOpenChange, onSuccess }) {
  const t = useTranslate();
  const currentUser = useCurrentUser();
  const [state, setState] = reactExports.useState({
    description: "",
    expiration: 3600 * 8
  });
  const requestState = useLoading(false);
  const expirationOptions = [
    {
      label: t("setting.access-token-section.create-dialog.duration-8h"),
      value: 3600 * 8
    },
    {
      label: t("setting.access-token-section.create-dialog.duration-1m"),
      value: 3600 * 24 * 30
    },
    {
      label: t("setting.access-token-section.create-dialog.duration-never"),
      value: 0
    }
  ];
  const setPartialState = (partialState) => {
    setState({
      ...state,
      ...partialState
    });
  };
  const handleDescriptionInputChange = (e) => {
    setPartialState({
      description: e.target.value
    });
  };
  const handleRoleInputChange = (value) => {
    setPartialState({
      expiration: Number(value)
    });
  };
  const handleSaveBtnClick = async () => {
    if (!state.description) {
      c.error(t("message.description-is-required"));
      return;
    }
    try {
      requestState.setLoading();
      await userServiceClient.createUserAccessToken({
        parent: currentUser.name,
        accessToken: {
          description: state.description,
          expiresAt: state.expiration ? new Date(Date.now() + state.expiration * 1e3) : void 0
        }
      });
      requestState.setFinish();
      onSuccess();
      onOpenChange(false);
    } catch (error) {
      c.error(error.details);
      console.error(error);
      requestState.setError();
    }
  };
  return /* @__PURE__ */ jsxRuntimeExports.jsx(Dialog, { open, onOpenChange, children: /* @__PURE__ */ jsxRuntimeExports.jsxs(DialogContent, { className: "max-w-md", children: [
    /* @__PURE__ */ jsxRuntimeExports.jsx(DialogHeader, { children: /* @__PURE__ */ jsxRuntimeExports.jsx(DialogTitle, { children: t("setting.access-token-section.create-dialog.create-access-token") }) }),
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex flex-col gap-4", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "grid gap-2", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsxs(Label, { htmlFor: "description", children: [
          t("setting.access-token-section.create-dialog.description"),
          " ",
          /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-destructive", children: "*" })
        ] }),
        /* @__PURE__ */ jsxRuntimeExports.jsx(
          Input,
          {
            id: "description",
            type: "text",
            placeholder: t("setting.access-token-section.create-dialog.some-description"),
            value: state.description,
            onChange: handleDescriptionInputChange
          }
        )
      ] }),
      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "grid gap-2", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsxs(Label, { children: [
          t("setting.access-token-section.create-dialog.expiration"),
          " ",
          /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-destructive", children: "*" })
        ] }),
        /* @__PURE__ */ jsxRuntimeExports.jsx(RadioGroup, { value: state.expiration.toString(), onValueChange: handleRoleInputChange, className: "flex flex-row gap-4", children: expirationOptions.map((option) => /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center space-x-2", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx(RadioGroupItem, { value: option.value.toString(), id: `expiration-${option.value}` }),
          /* @__PURE__ */ jsxRuntimeExports.jsx(Label, { htmlFor: `expiration-${option.value}`, children: option.label })
        ] }, option.value)) })
      ] })
    ] }),
    /* @__PURE__ */ jsxRuntimeExports.jsxs(DialogFooter, { children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx(Button, { variant: "ghost", disabled: requestState.isLoading, onClick: () => onOpenChange(false), children: t("common.cancel") }),
      /* @__PURE__ */ jsxRuntimeExports.jsx(Button, { disabled: requestState.isLoading, onClick: handleSaveBtnClick, children: t("common.create") })
    ] })
  ] }) });
}
const LearnMore = (props) => {
  const { className, url, title } = props;
  const t = useTranslate();
  return /* @__PURE__ */ jsxRuntimeExports.jsx(TooltipProvider, { children: /* @__PURE__ */ jsxRuntimeExports.jsxs(Tooltip, { children: [
    /* @__PURE__ */ jsxRuntimeExports.jsx(TooltipTrigger, { asChild: true, children: /* @__PURE__ */ jsxRuntimeExports.jsx("a", { className: `text-muted-foreground hover:text-primary ${className}`, href: url, target: "_blank", children: /* @__PURE__ */ jsxRuntimeExports.jsx(ExternalLink, { className: "w-4 h-auto" }) }) }),
    /* @__PURE__ */ jsxRuntimeExports.jsx(TooltipContent, { children: /* @__PURE__ */ jsxRuntimeExports.jsx("p", { children: title ?? t("common.learn-more") }) })
  ] }) });
};
const listAccessTokens = async (parent) => {
  const { accessTokens } = await userServiceClient.listUserAccessTokens({ parent });
  return accessTokens.sort((a, b) => (b.issuedAt?.getTime() ?? 0) - (a.issuedAt?.getTime() ?? 0));
};
const AccessTokenSection = () => {
  const t = useTranslate();
  const currentUser = useCurrentUser();
  const [userAccessTokens, setUserAccessTokens] = reactExports.useState([]);
  const createTokenDialog = useDialog();
  reactExports.useEffect(() => {
    listAccessTokens(currentUser.name).then((accessTokens) => {
      setUserAccessTokens(accessTokens);
    });
  }, []);
  const handleCreateAccessTokenDialogConfirm = async () => {
    const accessTokens = await listAccessTokens(currentUser.name);
    setUserAccessTokens(accessTokens);
  };
  const handleCreateToken = () => {
    createTokenDialog.open();
  };
  const copyAccessToken = (accessToken) => {
    copy(accessToken);
    c.success(t("setting.access-token-section.access-token-copied-to-clipboard"));
  };
  const handleDeleteAccessToken = async (userAccessToken) => {
    const formatedAccessToken = getFormatedAccessToken(userAccessToken.accessToken);
    const confirmed = window.confirm(t("setting.access-token-section.access-token-deletion", { accessToken: formatedAccessToken }));
    if (confirmed) {
      await userServiceClient.deleteUserAccessToken({ name: userAccessToken.name });
      setUserAccessTokens(userAccessTokens.filter((token) => token.accessToken !== userAccessToken.accessToken));
    }
  };
  const getFormatedAccessToken = (accessToken) => {
    return `${accessToken.slice(0, 4)}****${accessToken.slice(-4)}`;
  };
  return /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "mt-6 w-full flex flex-col justify-start items-start space-y-4", children: [
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "w-full", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "sm:flex sm:items-center sm:justify-between", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "sm:flex-auto space-y-1", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsxs("p", { className: "flex flex-row justify-start items-center font-medium text-muted-foreground", children: [
            t("setting.access-token-section.title"),
            /* @__PURE__ */ jsxRuntimeExports.jsx(LearnMore, { className: "ml-2", url: "https://usememos.com/docs/security/access-tokens" })
          ] }),
          /* @__PURE__ */ jsxRuntimeExports.jsx("p", { className: "text-sm text-muted-foreground", children: t("setting.access-token-section.description") })
        ] }),
        /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "mt-4 sm:mt-0", children: /* @__PURE__ */ jsxRuntimeExports.jsx(Button, { color: "primary", onClick: handleCreateToken, children: t("common.create") }) })
      ] }),
      /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "w-full mt-2 flow-root", children: /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "overflow-x-auto", children: /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "inline-block min-w-full border border-border rounded-lg align-middle", children: /* @__PURE__ */ jsxRuntimeExports.jsxs("table", { className: "min-w-full divide-y divide-border", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx("thead", { children: /* @__PURE__ */ jsxRuntimeExports.jsxs("tr", { children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx("th", { scope: "col", className: "px-3 py-2 text-left text-sm font-semibold text-foreground", children: t("setting.access-token-section.token") }),
          /* @__PURE__ */ jsxRuntimeExports.jsx("th", { scope: "col", className: "py-2 pl-4 pr-3 text-left text-sm font-semibold text-foreground", children: t("common.description") }),
          /* @__PURE__ */ jsxRuntimeExports.jsx("th", { scope: "col", className: "px-3 py-2 text-left text-sm font-semibold text-foreground", children: t("setting.access-token-section.create-dialog.created-at") }),
          /* @__PURE__ */ jsxRuntimeExports.jsx("th", { scope: "col", className: "px-3 py-2 text-left text-sm font-semibold text-foreground", children: t("setting.access-token-section.create-dialog.expires-at") }),
          /* @__PURE__ */ jsxRuntimeExports.jsx("th", { scope: "col", className: "relative py-3.5 pl-3 pr-4", children: /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "sr-only", children: t("common.delete") }) })
        ] }) }),
        /* @__PURE__ */ jsxRuntimeExports.jsx("tbody", { className: "divide-y divide-border", children: userAccessTokens.map((userAccessToken) => /* @__PURE__ */ jsxRuntimeExports.jsxs("tr", { children: [
          /* @__PURE__ */ jsxRuntimeExports.jsxs("td", { className: "whitespace-nowrap px-3 py-2 text-sm text-foreground flex flex-row justify-start items-center gap-x-1", children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "font-mono", children: getFormatedAccessToken(userAccessToken.accessToken) }),
            /* @__PURE__ */ jsxRuntimeExports.jsx(Button, { variant: "ghost", onClick: () => copyAccessToken(userAccessToken.accessToken), children: /* @__PURE__ */ jsxRuntimeExports.jsx(Clipboard, { className: "w-4 h-auto text-muted-foreground" }) })
          ] }),
          /* @__PURE__ */ jsxRuntimeExports.jsx("td", { className: "whitespace-nowrap py-2 pl-4 pr-3 text-sm text-foreground", children: userAccessToken.description }),
          /* @__PURE__ */ jsxRuntimeExports.jsx("td", { className: "whitespace-nowrap px-3 py-2 text-sm text-muted-foreground", children: userAccessToken.issuedAt?.toLocaleString() }),
          /* @__PURE__ */ jsxRuntimeExports.jsx("td", { className: "whitespace-nowrap px-3 py-2 text-sm text-muted-foreground", children: userAccessToken.expiresAt?.toLocaleString() ?? t("setting.access-token-section.create-dialog.duration-never") }),
          /* @__PURE__ */ jsxRuntimeExports.jsx("td", { className: "relative whitespace-nowrap py-2 pl-3 pr-4 text-right text-sm", children: /* @__PURE__ */ jsxRuntimeExports.jsx(
            Button,
            {
              variant: "ghost",
              onClick: () => {
                handleDeleteAccessToken(userAccessToken);
              },
              children: /* @__PURE__ */ jsxRuntimeExports.jsx(Trash, { className: "text-destructive w-4 h-auto" })
            }
          ) })
        ] }, userAccessToken.accessToken)) })
      ] }) }) }) })
    ] }),
    /* @__PURE__ */ jsxRuntimeExports.jsx(
      CreateAccessTokenDialog,
      {
        open: createTokenDialog.isOpen,
        onOpenChange: createTokenDialog.setOpen,
        onSuccess: handleCreateAccessTokenDialogConfirm
      }
    )
  ] });
};
const listUserSessions = async (parent) => {
  const { sessions } = await userServiceClient.listUserSessions({ parent });
  return sessions.sort((a, b) => (b.lastAccessedTime?.getTime() ?? 0) - (a.lastAccessedTime?.getTime() ?? 0));
};
const UserSessionsSection = () => {
  const t = useTranslate();
  const currentUser = useCurrentUser();
  const [userSessions, setUserSessions] = reactExports.useState([]);
  reactExports.useEffect(() => {
    listUserSessions(currentUser.name).then((sessions) => {
      setUserSessions(sessions);
    });
  }, []);
  const handleRevokeSession = async (userSession) => {
    const formattedSessionId = getFormattedSessionId(userSession.sessionId);
    const confirmed = window.confirm(t("setting.user-sessions-section.session-revocation", { sessionId: formattedSessionId }));
    if (confirmed) {
      await userServiceClient.revokeUserSession({ name: userSession.name });
      setUserSessions(userSessions.filter((session) => session.sessionId !== userSession.sessionId));
      c.success(t("setting.user-sessions-section.session-revoked"));
    }
  };
  const getFormattedSessionId = (sessionId) => {
    return `${sessionId.slice(0, 8)}...${sessionId.slice(-8)}`;
  };
  const getDeviceIcon = (deviceType) => {
    switch (deviceType?.toLowerCase()) {
      case "mobile":
        return /* @__PURE__ */ jsxRuntimeExports.jsx(Smartphone, { className: "w-4 h-4 text-muted-foreground" });
      case "tablet":
        return /* @__PURE__ */ jsxRuntimeExports.jsx(Tablet, { className: "w-4 h-4 text-muted-foreground" });
      case "desktop":
      default:
        return /* @__PURE__ */ jsxRuntimeExports.jsx(Monitor, { className: "w-4 h-4 text-muted-foreground" });
    }
  };
  const formatDeviceInfo = (clientInfo) => {
    if (!clientInfo) return "Unknown Device";
    const parts = [];
    if (clientInfo.os) parts.push(clientInfo.os);
    if (clientInfo.browser) parts.push(clientInfo.browser);
    return parts.length > 0 ? parts.join(" • ") : "Unknown Device";
  };
  const isCurrentSession = (session) => {
    if (userSessions.length === 0) return false;
    const mostRecent = userSessions[0];
    return session.sessionId === mostRecent.sessionId;
  };
  return /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "mt-6 w-full flex flex-col justify-start items-start space-y-4", children: /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "w-full", children: [
    /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "sm:flex sm:items-center sm:justify-between", children: /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "sm:flex-auto space-y-1", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsxs("p", { className: "flex flex-row justify-start items-center font-medium text-muted-foreground", children: [
        t("setting.user-sessions-section.title"),
        /* @__PURE__ */ jsxRuntimeExports.jsx(LearnMore, { className: "ml-2", url: "https://usememos.com/docs/security/sessions" })
      ] }),
      /* @__PURE__ */ jsxRuntimeExports.jsx("p", { className: "text-sm text-muted-foreground", children: t("setting.user-sessions-section.description") })
    ] }) }),
    /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "w-full mt-2 flow-root", children: /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "overflow-x-auto", children: /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "inline-block min-w-full border border-border rounded-lg align-middle", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsxs("table", { className: "min-w-full divide-y divide-border", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx("thead", { children: /* @__PURE__ */ jsxRuntimeExports.jsxs("tr", { children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx("th", { scope: "col", className: "px-3 py-2 text-left text-sm font-semibold text-foreground", children: t("setting.user-sessions-section.device") }),
          /* @__PURE__ */ jsxRuntimeExports.jsx("th", { scope: "col", className: "px-3 py-2 text-left text-sm font-semibold text-foreground", children: t("setting.user-sessions-section.last-active") }),
          /* @__PURE__ */ jsxRuntimeExports.jsx("th", { scope: "col", className: "relative py-3.5 pl-3 pr-4", children: /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "sr-only", children: t("common.delete") }) })
        ] }) }),
        /* @__PURE__ */ jsxRuntimeExports.jsx("tbody", { className: "divide-y divide-border", children: userSessions.map((userSession) => /* @__PURE__ */ jsxRuntimeExports.jsxs("tr", { children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx("td", { className: "whitespace-nowrap px-3 py-2 text-sm text-foreground", children: /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center space-x-3", children: [
            getDeviceIcon(userSession.clientInfo?.deviceType || ""),
            /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex flex-col", children: [
              /* @__PURE__ */ jsxRuntimeExports.jsxs("span", { className: "font-medium", children: [
                formatDeviceInfo(userSession.clientInfo),
                isCurrentSession(userSession) && /* @__PURE__ */ jsxRuntimeExports.jsxs("span", { className: "ml-2 inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-primary/20 text-primary", children: [
                  /* @__PURE__ */ jsxRuntimeExports.jsx(Wifi, { className: "w-3 h-3 mr-1" }),
                  t("setting.user-sessions-section.current")
                ] })
              ] }),
              /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-xs text-muted-foreground font-mono", children: getFormattedSessionId(userSession.sessionId) })
            ] })
          ] }) }),
          /* @__PURE__ */ jsxRuntimeExports.jsx("td", { className: "whitespace-nowrap px-3 py-2 text-sm text-muted-foreground", children: /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center space-x-1", children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx(Clock, { className: "w-4 h-4" }),
            /* @__PURE__ */ jsxRuntimeExports.jsx("span", { children: userSession.lastAccessedTime?.toLocaleString() })
          ] }) }),
          /* @__PURE__ */ jsxRuntimeExports.jsx("td", { className: "relative whitespace-nowrap py-2 pl-3 pr-4 text-right text-sm", children: /* @__PURE__ */ jsxRuntimeExports.jsx(
            Button,
            {
              variant: "ghost",
              disabled: isCurrentSession(userSession),
              onClick: () => {
                handleRevokeSession(userSession);
              },
              title: isCurrentSession(userSession) ? t("setting.user-sessions-section.cannot-revoke-current") : t("setting.user-sessions-section.revoke-session"),
              children: /* @__PURE__ */ jsxRuntimeExports.jsx(
                Trash,
                {
                  className: `w-4 h-auto ${isCurrentSession(userSession) ? "text-muted-foreground" : "text-destructive"}`
                }
              )
            }
          ) })
        ] }, userSession.sessionId)) })
      ] }),
      userSessions.length === 0 && /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "text-center py-8 text-muted-foreground", children: t("setting.user-sessions-section.no-sessions") })
    ] }) }) })
  ] }) });
};
const MyAccountSection = () => {
  const t = useTranslate();
  const user = useCurrentUser();
  const accountDialog = useDialog();
  const passwordDialog = useDialog();
  const handleEditAccount = () => {
    accountDialog.open();
  };
  const handleChangePassword = () => {
    passwordDialog.open();
  };
  return /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "w-full gap-2 pt-2 pb-4", children: [
    /* @__PURE__ */ jsxRuntimeExports.jsx("p", { className: "font-medium text-muted-foreground", children: t("setting.account-section.title") }),
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "w-full mt-2 flex flex-row justify-start items-center", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx(UserAvatar, { className: "mr-2 shrink-0 w-10 h-10", avatarUrl: user.avatarUrl }),
      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "max-w-[calc(100%-3rem)] flex flex-col justify-center items-start", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsxs("p", { className: "w-full", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-xl leading-tight font-medium", children: user.displayName }),
          /* @__PURE__ */ jsxRuntimeExports.jsxs("span", { className: "ml-1 text-base leading-tight text-muted-foreground", children: [
            "(",
            user.username,
            ")"
          ] })
        ] }),
        /* @__PURE__ */ jsxRuntimeExports.jsx("p", { className: "w-4/5 leading-tight text-sm truncate", children: user.description })
      ] })
    ] }),
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "w-full flex flex-row justify-start items-center mt-2 space-x-2", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsxs(Button, { variant: "outline", onClick: handleEditAccount, children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx(PenLine, { className: "w-4 h-4 mx-auto mr-1" }),
        t("common.edit")
      ] }),
      /* @__PURE__ */ jsxRuntimeExports.jsxs(DropdownMenu, { children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx(DropdownMenuTrigger, { asChild: true, children: /* @__PURE__ */ jsxRuntimeExports.jsx(Button, { variant: "outline", children: /* @__PURE__ */ jsxRuntimeExports.jsx(EllipsisVertical, { className: "w-4 h-4 mx-auto" }) }) }),
        /* @__PURE__ */ jsxRuntimeExports.jsx(DropdownMenuContent, { align: "start", children: /* @__PURE__ */ jsxRuntimeExports.jsx(DropdownMenuItem, { onClick: handleChangePassword, children: t("setting.account-section.change-password") }) })
      ] })
    ] }),
    /* @__PURE__ */ jsxRuntimeExports.jsx(UserSessionsSection, {}),
    /* @__PURE__ */ jsxRuntimeExports.jsx(AccessTokenSection, {}),
    /* @__PURE__ */ jsxRuntimeExports.jsx(UpdateAccountDialog, { open: accountDialog.isOpen, onOpenChange: accountDialog.setOpen }),
    /* @__PURE__ */ jsxRuntimeExports.jsx(ChangeMemberPasswordDialog, { open: passwordDialog.isOpen, onOpenChange: passwordDialog.setOpen, user })
  ] });
};
const THEMES = [
  { value: "default", label: "Default" },
  { value: "paper", label: "Paper" },
  { value: "whitewall", label: "Whitewall" }
];
const ThemeSelector = ({ value = "default", onValueChange, className }) => {
  return /* @__PURE__ */ jsxRuntimeExports.jsxs(Select, { value, onValueChange, children: [
    /* @__PURE__ */ jsxRuntimeExports.jsx(SelectTrigger, { className, children: /* @__PURE__ */ jsxRuntimeExports.jsx(SelectValue, {}) }),
    /* @__PURE__ */ jsxRuntimeExports.jsx(SelectContent, { children: THEMES.map((theme) => /* @__PURE__ */ jsxRuntimeExports.jsx(SelectItem, { value: theme.value, children: theme.label }, theme.value)) })
  ] });
};
function CreateWebhookDialog({ open, onOpenChange, webhookName, onSuccess }) {
  const t = useTranslate();
  const currentUser = useCurrentUser();
  const [state, setState] = reactExports.useState({
    displayName: "",
    url: ""
  });
  const requestState = useLoading(false);
  const isCreating = webhookName === void 0;
  reactExports.useEffect(() => {
    if (webhookName && currentUser) {
      userServiceClient.listUserWebhooks({
        parent: currentUser.name
      }).then((response) => {
        const webhook = response.webhooks.find((w) => w.name === webhookName);
        if (webhook) {
          setState({
            displayName: webhook.displayName,
            url: webhook.url
          });
        }
      });
    }
  }, [webhookName, currentUser]);
  const setPartialState = (partialState) => {
    setState({
      ...state,
      ...partialState
    });
  };
  const handleTitleInputChange = (e) => {
    setPartialState({
      displayName: e.target.value
    });
  };
  const handleUrlInputChange = (e) => {
    setPartialState({
      url: e.target.value
    });
  };
  const handleSaveBtnClick = async () => {
    if (!state.displayName || !state.url) {
      c.error(t("message.fill-all-required-fields"));
      return;
    }
    if (!currentUser) {
      c.error("User not authenticated");
      return;
    }
    try {
      requestState.setLoading();
      if (isCreating) {
        await userServiceClient.createUserWebhook({
          parent: currentUser.name,
          webhook: {
            displayName: state.displayName,
            url: state.url
          }
        });
      } else {
        await userServiceClient.updateUserWebhook({
          webhook: {
            name: webhookName,
            displayName: state.displayName,
            url: state.url
          },
          updateMask: ["display_name", "url"]
        });
      }
      onSuccess?.();
      onOpenChange(false);
      requestState.setFinish();
    } catch (error) {
      console.error(error);
      c.error(error.details);
      requestState.setError();
    }
  };
  return /* @__PURE__ */ jsxRuntimeExports.jsx(Dialog, { open, onOpenChange, children: /* @__PURE__ */ jsxRuntimeExports.jsxs(DialogContent, { className: "max-w-md", children: [
    /* @__PURE__ */ jsxRuntimeExports.jsx(DialogHeader, { children: /* @__PURE__ */ jsxRuntimeExports.jsx(DialogTitle, { children: isCreating ? t("setting.webhook-section.create-dialog.create-webhook") : t("setting.webhook-section.create-dialog.edit-webhook") }) }),
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex flex-col gap-4", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "grid gap-2", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsxs(Label, { htmlFor: "displayName", children: [
          t("setting.webhook-section.create-dialog.title"),
          " ",
          /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-destructive", children: "*" })
        ] }),
        /* @__PURE__ */ jsxRuntimeExports.jsx(
          Input,
          {
            id: "displayName",
            type: "text",
            placeholder: t("setting.webhook-section.create-dialog.an-easy-to-remember-name"),
            value: state.displayName,
            onChange: handleTitleInputChange
          }
        )
      ] }),
      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "grid gap-2", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsxs(Label, { htmlFor: "url", children: [
          t("setting.webhook-section.create-dialog.payload-url"),
          " ",
          /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-destructive", children: "*" })
        ] }),
        /* @__PURE__ */ jsxRuntimeExports.jsx(
          Input,
          {
            id: "url",
            type: "text",
            placeholder: t("setting.webhook-section.create-dialog.url-example-post-receive"),
            value: state.url,
            onChange: handleUrlInputChange
          }
        )
      ] })
    ] }),
    /* @__PURE__ */ jsxRuntimeExports.jsxs(DialogFooter, { children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx(Button, { variant: "ghost", disabled: requestState.isLoading, onClick: () => onOpenChange(false), children: t("common.cancel") }),
      /* @__PURE__ */ jsxRuntimeExports.jsx(Button, { disabled: requestState.isLoading, onClick: handleSaveBtnClick, children: t("common.create") })
    ] })
  ] }) });
}
const WebhookSection = () => {
  const t = useTranslate();
  const currentUser = useCurrentUser();
  const [webhooks, setWebhooks] = reactExports.useState([]);
  const [isCreateWebhookDialogOpen, setIsCreateWebhookDialogOpen] = reactExports.useState(false);
  const listWebhooks = async () => {
    if (!currentUser) return [];
    const { webhooks: webhooks2 } = await userServiceClient.listUserWebhooks({
      parent: currentUser.name
    });
    return webhooks2;
  };
  reactExports.useEffect(() => {
    listWebhooks().then((webhooks2) => {
      setWebhooks(webhooks2);
    });
  }, [currentUser]);
  const handleCreateWebhookDialogConfirm = async () => {
    const webhooks2 = await listWebhooks();
    setWebhooks(webhooks2);
    setIsCreateWebhookDialogOpen(false);
  };
  const handleDeleteWebhook = async (webhook) => {
    const confirmed = window.confirm(`Are you sure to delete webhook \`${webhook.displayName}\`? You cannot undo this action.`);
    if (confirmed) {
      await userServiceClient.deleteUserWebhook({ name: webhook.name });
      setWebhooks(webhooks.filter((item) => item.name !== webhook.name));
    }
  };
  return /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "w-full flex flex-col justify-start items-start", children: [
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "w-full flex justify-between items-center", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "flex-auto space-y-1", children: /* @__PURE__ */ jsxRuntimeExports.jsx("p", { className: "flex flex-row justify-start items-center font-medium text-muted-foreground", children: t("setting.webhook-section.title") }) }),
      /* @__PURE__ */ jsxRuntimeExports.jsx("div", { children: /* @__PURE__ */ jsxRuntimeExports.jsx(Button, { color: "primary", onClick: () => setIsCreateWebhookDialogOpen(true), children: t("common.create") }) })
    ] }),
    /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "w-full mt-2 flow-root", children: /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "overflow-x-auto", children: /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "inline-block min-w-full border border-border rounded-lg align-middle", children: /* @__PURE__ */ jsxRuntimeExports.jsxs("table", { className: "min-w-full divide-y divide-border", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx("thead", { children: /* @__PURE__ */ jsxRuntimeExports.jsxs("tr", { children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx("th", { scope: "col", className: "px-3 py-2 text-left text-sm font-semibold text-foreground", children: t("common.name") }),
        /* @__PURE__ */ jsxRuntimeExports.jsx("th", { scope: "col", className: "px-3 py-2 text-left text-sm font-semibold text-foreground", children: t("setting.webhook-section.url") }),
        /* @__PURE__ */ jsxRuntimeExports.jsx("th", { scope: "col", className: "relative px-3 py-2 pr-4", children: /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "sr-only", children: t("common.delete") }) })
      ] }) }),
      /* @__PURE__ */ jsxRuntimeExports.jsxs("tbody", { className: "divide-y divide-border", children: [
        webhooks.map((webhook) => /* @__PURE__ */ jsxRuntimeExports.jsxs("tr", { children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx("td", { className: "whitespace-nowrap px-3 py-2 text-sm text-foreground", children: webhook.displayName }),
          /* @__PURE__ */ jsxRuntimeExports.jsx("td", { className: "max-w-[200px] px-3 py-2 text-sm text-foreground truncate", title: webhook.url, children: webhook.url }),
          /* @__PURE__ */ jsxRuntimeExports.jsx("td", { className: "relative whitespace-nowrap px-3 py-2 text-right text-sm", children: /* @__PURE__ */ jsxRuntimeExports.jsx(
            Button,
            {
              variant: "ghost",
              onClick: () => {
                handleDeleteWebhook(webhook);
              },
              children: /* @__PURE__ */ jsxRuntimeExports.jsx(Trash, { className: "text-destructive w-4 h-auto" })
            }
          ) })
        ] }, webhook.name)),
        webhooks.length === 0 && /* @__PURE__ */ jsxRuntimeExports.jsx("tr", { children: /* @__PURE__ */ jsxRuntimeExports.jsx("td", { className: "whitespace-nowrap px-3 py-2 text-sm text-foreground", colSpan: 3, children: t("setting.webhook-section.no-webhooks-found") }) })
      ] })
    ] }) }) }) }),
    /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "w-full mt-2", children: /* @__PURE__ */ jsxRuntimeExports.jsxs(
      Link,
      {
        className: "text-muted-foreground text-sm inline-flex flex-row justify-start items-center hover:underline hover:text-primary",
        to: "https://usememos.com/docs/advanced-settings/webhook",
        target: "_blank",
        children: [
          t("common.learn-more"),
          /* @__PURE__ */ jsxRuntimeExports.jsx(ExternalLink, { className: "inline w-4 h-auto ml-1" })
        ]
      }
    ) }),
    /* @__PURE__ */ jsxRuntimeExports.jsx(
      CreateWebhookDialog,
      {
        open: isCreateWebhookDialogOpen,
        onOpenChange: setIsCreateWebhookDialogOpen,
        onSuccess: handleCreateWebhookDialogConfirm
      }
    )
  ] });
};
const PreferencesSection = observer(() => {
  const t = useTranslate();
  const generalSetting = userStore.state.userGeneralSetting;
  const handleLocaleSelectChange = async (locale) => {
    await userStore.updateUserGeneralSetting({ locale }, ["locale"]);
  };
  const handleAppearanceSelectChange = async (appearance) => {
    await userStore.updateUserGeneralSetting({ appearance }, ["appearance"]);
  };
  const handleDefaultMemoVisibilityChanged = async (value) => {
    await userStore.updateUserGeneralSetting({ memoVisibility: value }, ["memoVisibility"]);
  };
  const handleThemeChange = async (theme) => {
    await userStore.updateUserGeneralSetting({ theme }, ["theme"]);
  };
  const setting = generalSetting || {
    locale: "en",
    appearance: "system",
    memoVisibility: "PRIVATE",
    theme: ""
  };
  return /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "w-full flex flex-col gap-2 pt-2 pb-4", children: [
    /* @__PURE__ */ jsxRuntimeExports.jsx("p", { className: "font-medium text-muted-foreground", children: t("common.basic") }),
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "w-full flex flex-row justify-between items-center", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx("span", { children: t("common.language") }),
      /* @__PURE__ */ jsxRuntimeExports.jsx(LocaleSelect, { value: setting.locale, onChange: handleLocaleSelectChange })
    ] }),
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "w-full flex flex-row justify-between items-center", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx("span", { children: t("setting.preference-section.apperance") }),
      /* @__PURE__ */ jsxRuntimeExports.jsx(AppearanceSelect, { value: setting.appearance, onChange: handleAppearanceSelectChange })
    ] }),
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "w-full flex flex-row justify-between items-center", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx("span", { children: t("setting.preference-section.theme") }),
      /* @__PURE__ */ jsxRuntimeExports.jsx(ThemeSelector, { value: setting.theme, onValueChange: handleThemeChange })
    ] }),
    /* @__PURE__ */ jsxRuntimeExports.jsx("p", { className: "font-medium text-muted-foreground", children: t("setting.preference") }),
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "w-full flex flex-row justify-between items-center", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "truncate", children: t("setting.preference-section.default-memo-visibility") }),
      /* @__PURE__ */ jsxRuntimeExports.jsxs(Select, { value: setting.memoVisibility, onValueChange: handleDefaultMemoVisibilityChanged, children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx(SelectTrigger, { className: "min-w-fit", children: /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center gap-2", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx(VisibilityIcon, { visibility: convertVisibilityFromString(setting.memoVisibility) }),
          /* @__PURE__ */ jsxRuntimeExports.jsx(SelectValue, {})
        ] }) }),
        /* @__PURE__ */ jsxRuntimeExports.jsx(SelectContent, { children: [Visibility.PRIVATE, Visibility.PROTECTED, Visibility.PUBLIC].map((v) => convertVisibilityToString(v)).map((item) => /* @__PURE__ */ jsxRuntimeExports.jsx(SelectItem, { value: item, className: "whitespace-nowrap", children: t(`memo.visibility.${item.toLowerCase()}`) }, item)) })
      ] })
    ] }),
    /* @__PURE__ */ jsxRuntimeExports.jsx(Separator, { className: "my-3" }),
    /* @__PURE__ */ jsxRuntimeExports.jsx(WebhookSection, {})
  ] });
});
const templateList = [
  {
    name: "",
    title: "GitHub",
    type: IdentityProvider_Type.OAUTH2,
    identifierFilter: "",
    config: {
      oauth2Config: {
        clientId: "",
        clientSecret: "",
        authUrl: "https://github.com/login/oauth/authorize",
        tokenUrl: "https://github.com/login/oauth/access_token",
        userInfoUrl: "https://api.github.com/user",
        scopes: ["read:user"],
        fieldMapping: FieldMapping.fromPartial({
          identifier: "login",
          displayName: "name",
          email: "email"
        })
      }
    }
  },
  {
    name: "",
    title: "GitLab",
    type: IdentityProvider_Type.OAUTH2,
    identifierFilter: "",
    config: {
      oauth2Config: {
        clientId: "",
        clientSecret: "",
        authUrl: "https://gitlab.com/oauth/authorize",
        tokenUrl: "https://gitlab.com/oauth/token",
        userInfoUrl: "https://gitlab.com/oauth/userinfo",
        scopes: ["openid"],
        fieldMapping: FieldMapping.fromPartial({
          identifier: "name",
          displayName: "name",
          email: "email"
        })
      }
    }
  },
  {
    name: "",
    title: "Google",
    type: IdentityProvider_Type.OAUTH2,
    identifierFilter: "",
    config: {
      oauth2Config: {
        clientId: "",
        clientSecret: "",
        authUrl: "https://accounts.google.com/o/oauth2/v2/auth",
        tokenUrl: "https://oauth2.googleapis.com/token",
        userInfoUrl: "https://www.googleapis.com/oauth2/v2/userinfo",
        scopes: ["https://www.googleapis.com/auth/userinfo.email", "https://www.googleapis.com/auth/userinfo.profile"],
        fieldMapping: FieldMapping.fromPartial({
          identifier: "email",
          displayName: "name",
          email: "email"
        })
      }
    }
  },
  {
    name: "",
    title: "Custom",
    type: IdentityProvider_Type.OAUTH2,
    identifierFilter: "",
    config: {
      oauth2Config: {
        clientId: "",
        clientSecret: "",
        authUrl: "",
        tokenUrl: "",
        userInfoUrl: "",
        scopes: [],
        fieldMapping: FieldMapping.fromPartial({
          identifier: "",
          displayName: "",
          email: ""
        })
      }
    }
  }
];
function CreateIdentityProviderDialog({ open, onOpenChange, identityProvider, onSuccess }) {
  const t = useTranslate();
  const identityProviderTypes = [...new Set(templateList.map((t2) => t2.type))];
  const [basicInfo, setBasicInfo] = reactExports.useState({
    title: "",
    identifierFilter: ""
  });
  const [type, setType] = reactExports.useState(IdentityProvider_Type.OAUTH2);
  const [oauth2Config, setOAuth2Config] = reactExports.useState({
    clientId: "",
    clientSecret: "",
    authUrl: "",
    tokenUrl: "",
    userInfoUrl: "",
    scopes: [],
    fieldMapping: FieldMapping.fromPartial({
      identifier: "",
      displayName: "",
      email: ""
    })
  });
  const [oauth2Scopes, setOAuth2Scopes] = reactExports.useState("");
  const [selectedTemplate, setSelectedTemplate] = reactExports.useState("GitHub");
  const isCreating = identityProvider === void 0;
  reactExports.useEffect(() => {
    if (identityProvider) {
      setBasicInfo({
        title: identityProvider.title,
        identifierFilter: identityProvider.identifierFilter
      });
      setType(identityProvider.type);
      if (identityProvider.type === IdentityProvider_Type.OAUTH2) {
        const oauth2Config2 = OAuth2Config.fromPartial(identityProvider.config?.oauth2Config || {});
        setOAuth2Config(oauth2Config2);
        setOAuth2Scopes(oauth2Config2.scopes.join(" "));
      }
    }
  }, [identityProvider]);
  reactExports.useEffect(() => {
    if (!isCreating) {
      return;
    }
    const template = templateList.find((t2) => t2.title === selectedTemplate);
    if (template) {
      setBasicInfo({
        title: template.title,
        identifierFilter: template.identifierFilter
      });
      setType(template.type);
      if (template.type === IdentityProvider_Type.OAUTH2) {
        const oauth2Config2 = OAuth2Config.fromPartial(template.config?.oauth2Config || {});
        setOAuth2Config(oauth2Config2);
        setOAuth2Scopes(oauth2Config2.scopes.join(" "));
      }
    }
  }, [selectedTemplate]);
  const handleCloseBtnClick = () => {
    onOpenChange(false);
  };
  const allowConfirmAction = () => {
    if (basicInfo.title === "") {
      return false;
    }
    if (type === "OAUTH2") {
      if (oauth2Config.clientId === "" || oauth2Config.authUrl === "" || oauth2Config.tokenUrl === "" || oauth2Config.userInfoUrl === "" || oauth2Scopes === "" || oauth2Config.fieldMapping?.identifier === "") {
        return false;
      }
      if (isCreating) {
        if (oauth2Config.clientSecret === "") {
          return false;
        }
      }
    }
    return true;
  };
  const handleConfirmBtnClick = async () => {
    try {
      if (isCreating) {
        await identityProviderServiceClient.createIdentityProvider({
          identityProvider: {
            ...basicInfo,
            type,
            config: {
              oauth2Config: {
                ...oauth2Config,
                scopes: oauth2Scopes.split(" ")
              }
            }
          }
        });
        c.success(t("setting.sso-section.sso-created", { name: basicInfo.title }));
      } else {
        await identityProviderServiceClient.updateIdentityProvider({
          identityProvider: {
            ...basicInfo,
            name: identityProvider.name,
            type,
            config: {
              oauth2Config: {
                ...oauth2Config,
                scopes: oauth2Scopes.split(" ")
              }
            }
          },
          updateMask: ["title", "identifier_filter", "config"]
        });
        c.success(t("setting.sso-section.sso-updated", { name: basicInfo.title }));
      }
    } catch (error) {
      c.error(error.details);
      console.error(error);
    }
    onSuccess?.();
    onOpenChange(false);
  };
  const setPartialOAuth2Config = (state) => {
    setOAuth2Config({
      ...oauth2Config,
      ...state
    });
  };
  return /* @__PURE__ */ jsxRuntimeExports.jsx(Dialog, { open, onOpenChange, children: /* @__PURE__ */ jsxRuntimeExports.jsxs(DialogContent, { className: "max-w-2xl max-h-[80vh] overflow-y-auto", children: [
    /* @__PURE__ */ jsxRuntimeExports.jsx(DialogHeader, { children: /* @__PURE__ */ jsxRuntimeExports.jsx(DialogTitle, { children: t(isCreating ? "setting.sso-section.create-sso" : "setting.sso-section.update-sso") }) }),
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex flex-col justify-start items-start w-full space-y-4", children: [
      isCreating && /* @__PURE__ */ jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment, { children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx("p", { className: "mb-1!", children: t("common.type") }),
        /* @__PURE__ */ jsxRuntimeExports.jsxs(Select, { value: String(type), onValueChange: (value) => setType(parseInt(value)), children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx(SelectTrigger, { className: "w-full mb-4", children: /* @__PURE__ */ jsxRuntimeExports.jsx(SelectValue, {}) }),
          /* @__PURE__ */ jsxRuntimeExports.jsx(SelectContent, { children: identityProviderTypes.map((kind) => /* @__PURE__ */ jsxRuntimeExports.jsx(SelectItem, { value: String(kind), children: IdentityProvider_Type[kind] || kind }, kind)) })
        ] }),
        /* @__PURE__ */ jsxRuntimeExports.jsx("p", { className: "mb-2 text-sm font-medium", children: t("setting.sso-section.template") }),
        /* @__PURE__ */ jsxRuntimeExports.jsxs(Select, { value: selectedTemplate, onValueChange: (value) => setSelectedTemplate(value), children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx(SelectTrigger, { className: "mb-1 h-auto w-full", children: /* @__PURE__ */ jsxRuntimeExports.jsx(SelectValue, {}) }),
          /* @__PURE__ */ jsxRuntimeExports.jsx(SelectContent, { children: templateList.map((template) => /* @__PURE__ */ jsxRuntimeExports.jsx(SelectItem, { value: template.title, children: template.title }, template.title)) })
        ] }),
        /* @__PURE__ */ jsxRuntimeExports.jsx(Separator, { className: "my-2" })
      ] }),
      /* @__PURE__ */ jsxRuntimeExports.jsxs("p", { className: "mb-1 text-sm font-medium", children: [
        t("common.name"),
        /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-destructive", children: "*" })
      ] }),
      /* @__PURE__ */ jsxRuntimeExports.jsx(
        Input,
        {
          className: "mb-2 w-full",
          placeholder: t("common.name"),
          value: basicInfo.title,
          onChange: (e) => setBasicInfo({
            ...basicInfo,
            title: e.target.value
          })
        }
      ),
      /* @__PURE__ */ jsxRuntimeExports.jsx("p", { className: "mb-1 text-sm font-medium", children: t("setting.sso-section.identifier-filter") }),
      /* @__PURE__ */ jsxRuntimeExports.jsx(
        Input,
        {
          className: "mb-2 w-full",
          placeholder: t("setting.sso-section.identifier-filter"),
          value: basicInfo.identifierFilter,
          onChange: (e) => setBasicInfo({
            ...basicInfo,
            identifierFilter: e.target.value
          })
        }
      ),
      /* @__PURE__ */ jsxRuntimeExports.jsx(Separator, { className: "my-2" }),
      type === "OAUTH2" && /* @__PURE__ */ jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment, { children: [
        isCreating && /* @__PURE__ */ jsxRuntimeExports.jsxs("p", { className: "border border-border rounded-md p-2 text-sm w-full mb-2 break-all", children: [
          t("setting.sso-section.redirect-url"),
          ": ",
          absolutifyLink("/auth/callback")
        ] }),
        /* @__PURE__ */ jsxRuntimeExports.jsxs("p", { className: "mb-1 text-sm font-medium", children: [
          t("setting.sso-section.client-id"),
          /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-destructive", children: "*" })
        ] }),
        /* @__PURE__ */ jsxRuntimeExports.jsx(
          Input,
          {
            className: "mb-2 w-full",
            placeholder: t("setting.sso-section.client-id"),
            value: oauth2Config.clientId,
            onChange: (e) => setPartialOAuth2Config({ clientId: e.target.value })
          }
        ),
        /* @__PURE__ */ jsxRuntimeExports.jsxs("p", { className: "mb-1 text-sm font-medium", children: [
          t("setting.sso-section.client-secret"),
          /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-destructive", children: "*" })
        ] }),
        /* @__PURE__ */ jsxRuntimeExports.jsx(
          Input,
          {
            className: "mb-2 w-full",
            placeholder: t("setting.sso-section.client-secret"),
            value: oauth2Config.clientSecret,
            onChange: (e) => setPartialOAuth2Config({ clientSecret: e.target.value })
          }
        ),
        /* @__PURE__ */ jsxRuntimeExports.jsxs("p", { className: "mb-1 text-sm font-medium", children: [
          t("setting.sso-section.authorization-endpoint"),
          /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-destructive", children: "*" })
        ] }),
        /* @__PURE__ */ jsxRuntimeExports.jsx(
          Input,
          {
            className: "mb-2 w-full",
            placeholder: t("setting.sso-section.authorization-endpoint"),
            value: oauth2Config.authUrl,
            onChange: (e) => setPartialOAuth2Config({ authUrl: e.target.value })
          }
        ),
        /* @__PURE__ */ jsxRuntimeExports.jsxs("p", { className: "mb-1 text-sm font-medium", children: [
          t("setting.sso-section.token-endpoint"),
          /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-destructive", children: "*" })
        ] }),
        /* @__PURE__ */ jsxRuntimeExports.jsx(
          Input,
          {
            className: "mb-2 w-full",
            placeholder: t("setting.sso-section.token-endpoint"),
            value: oauth2Config.tokenUrl,
            onChange: (e) => setPartialOAuth2Config({ tokenUrl: e.target.value })
          }
        ),
        /* @__PURE__ */ jsxRuntimeExports.jsxs("p", { className: "mb-1 text-sm font-medium", children: [
          t("setting.sso-section.user-endpoint"),
          /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-destructive", children: "*" })
        ] }),
        /* @__PURE__ */ jsxRuntimeExports.jsx(
          Input,
          {
            className: "mb-2 w-full",
            placeholder: t("setting.sso-section.user-endpoint"),
            value: oauth2Config.userInfoUrl,
            onChange: (e) => setPartialOAuth2Config({ userInfoUrl: e.target.value })
          }
        ),
        /* @__PURE__ */ jsxRuntimeExports.jsxs("p", { className: "mb-1 text-sm font-medium", children: [
          t("setting.sso-section.scopes"),
          /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-destructive", children: "*" })
        ] }),
        /* @__PURE__ */ jsxRuntimeExports.jsx(
          Input,
          {
            className: "mb-2 w-full",
            placeholder: t("setting.sso-section.scopes"),
            value: oauth2Scopes,
            onChange: (e) => setOAuth2Scopes(e.target.value)
          }
        ),
        /* @__PURE__ */ jsxRuntimeExports.jsx(Separator, { className: "my-2" }),
        /* @__PURE__ */ jsxRuntimeExports.jsxs("p", { className: "mb-1 text-sm font-medium", children: [
          t("setting.sso-section.identifier"),
          /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-destructive", children: "*" })
        ] }),
        /* @__PURE__ */ jsxRuntimeExports.jsx(
          Input,
          {
            className: "mb-2 w-full",
            placeholder: t("setting.sso-section.identifier"),
            value: oauth2Config.fieldMapping.identifier,
            onChange: (e) => setPartialOAuth2Config({ fieldMapping: { ...oauth2Config.fieldMapping, identifier: e.target.value } })
          }
        ),
        /* @__PURE__ */ jsxRuntimeExports.jsx("p", { className: "mb-1 text-sm font-medium", children: t("setting.sso-section.display-name") }),
        /* @__PURE__ */ jsxRuntimeExports.jsx(
          Input,
          {
            className: "mb-2 w-full",
            placeholder: t("setting.sso-section.display-name"),
            value: oauth2Config.fieldMapping.displayName,
            onChange: (e) => setPartialOAuth2Config({ fieldMapping: { ...oauth2Config.fieldMapping, displayName: e.target.value } })
          }
        ),
        /* @__PURE__ */ jsxRuntimeExports.jsx("p", { className: "mb-1 text-sm font-medium", children: t("common.email") }),
        /* @__PURE__ */ jsxRuntimeExports.jsx(
          Input,
          {
            className: "mb-2 w-full",
            placeholder: t("common.email"),
            value: oauth2Config.fieldMapping.email,
            onChange: (e) => setPartialOAuth2Config({ fieldMapping: { ...oauth2Config.fieldMapping, email: e.target.value } })
          }
        ),
        /* @__PURE__ */ jsxRuntimeExports.jsx("p", { className: "mb-1 text-sm font-medium", children: "Avatar URL" }),
        /* @__PURE__ */ jsxRuntimeExports.jsx(
          Input,
          {
            className: "mb-2 w-full",
            placeholder: "Avatar URL",
            value: oauth2Config.fieldMapping.avatarUrl,
            onChange: (e) => setPartialOAuth2Config({ fieldMapping: { ...oauth2Config.fieldMapping, avatarUrl: e.target.value } })
          }
        )
      ] })
    ] }),
    /* @__PURE__ */ jsxRuntimeExports.jsxs(DialogFooter, { children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx(Button, { variant: "ghost", onClick: handleCloseBtnClick, children: t("common.cancel") }),
      /* @__PURE__ */ jsxRuntimeExports.jsx(Button, { onClick: handleConfirmBtnClick, disabled: !allowConfirmAction(), children: t(isCreating ? "common.create" : "common.update") })
    ] })
  ] }) });
}
const SSOSection = () => {
  const t = useTranslate();
  const [identityProviderList, setIdentityProviderList] = reactExports.useState([]);
  const [isCreateDialogOpen, setIsCreateDialogOpen] = reactExports.useState(false);
  const [editingIdentityProvider, setEditingIdentityProvider] = reactExports.useState();
  reactExports.useEffect(() => {
    fetchIdentityProviderList();
  }, []);
  const fetchIdentityProviderList = async () => {
    const { identityProviders } = await identityProviderServiceClient.listIdentityProviders({});
    setIdentityProviderList(identityProviders);
  };
  const handleDeleteIdentityProvider = async (identityProvider) => {
    const confirmed = window.confirm(t("setting.sso-section.confirm-delete", { name: identityProvider.title }));
    if (confirmed) {
      try {
        await identityProviderServiceClient.deleteIdentityProvider({ name: identityProvider.name });
      } catch (error) {
        console.error(error);
        c.error(error.details);
      }
      await fetchIdentityProviderList();
    }
  };
  const handleCreateIdentityProvider = () => {
    setEditingIdentityProvider(void 0);
    setIsCreateDialogOpen(true);
  };
  const handleEditIdentityProvider = (identityProvider) => {
    setEditingIdentityProvider(identityProvider);
    setIsCreateDialogOpen(true);
  };
  const handleDialogSuccess = async () => {
    await fetchIdentityProviderList();
    setIsCreateDialogOpen(false);
    setEditingIdentityProvider(void 0);
  };
  return /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "w-full flex flex-col gap-2 pt-2 pb-4", children: [
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "w-full flex flex-row justify-between items-center gap-1", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex flex-row items-center gap-1", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "font-mono text-muted-foreground", children: t("setting.sso-section.sso-list") }),
        /* @__PURE__ */ jsxRuntimeExports.jsx(LearnMore, { url: "https://www.usememos.com/docs/advanced-settings/sso" })
      ] }),
      /* @__PURE__ */ jsxRuntimeExports.jsx(Button, { color: "primary", onClick: handleCreateIdentityProvider, children: t("common.create") })
    ] }),
    /* @__PURE__ */ jsxRuntimeExports.jsx(Separator, {}),
    identityProviderList.map((identityProvider) => /* @__PURE__ */ jsxRuntimeExports.jsxs(
      "div",
      {
        className: "py-2 w-full border-b last:border-b border-border flex flex-row items-center justify-between",
        children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "flex flex-row items-center", children: /* @__PURE__ */ jsxRuntimeExports.jsxs("p", { className: "ml-2", children: [
            identityProvider.title,
            /* @__PURE__ */ jsxRuntimeExports.jsxs("span", { className: "text-sm ml-1 text-muted-foreground", children: [
              "(",
              identityProvider.type,
              ")"
            ] })
          ] }) }),
          /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "flex flex-row items-center", children: /* @__PURE__ */ jsxRuntimeExports.jsxs(DropdownMenu, { children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx(DropdownMenuTrigger, { asChild: true, children: /* @__PURE__ */ jsxRuntimeExports.jsx(Button, { variant: "outline", children: /* @__PURE__ */ jsxRuntimeExports.jsx(EllipsisVertical, { className: "w-4 h-auto" }) }) }),
            /* @__PURE__ */ jsxRuntimeExports.jsxs(DropdownMenuContent, { align: "end", sideOffset: 2, children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx(DropdownMenuItem, { onClick: () => handleEditIdentityProvider(identityProvider), children: t("common.edit") }),
              /* @__PURE__ */ jsxRuntimeExports.jsx(DropdownMenuItem, { onClick: () => handleDeleteIdentityProvider(identityProvider), children: t("common.delete") })
            ] })
          ] }) })
        ]
      },
      identityProvider.name
    )),
    identityProviderList.length === 0 && /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "w-full mt-2 text-sm border-border text-muted-foreground flex flex-row items-center justify-between", children: /* @__PURE__ */ jsxRuntimeExports.jsx("p", { className: "", children: t("setting.sso-section.no-sso-found") }) }),
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "w-full mt-4", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsxs("p", { className: "text-sm", children: [
        t("common.learn-more"),
        ":"
      ] }),
      /* @__PURE__ */ jsxRuntimeExports.jsx("ul", { className: "list-disc list-inside text-sm ml-4", children: /* @__PURE__ */ jsxRuntimeExports.jsx("li", { children: /* @__PURE__ */ jsxRuntimeExports.jsx(Link, { className: "text-sm text-primary hover:underline", to: "https://www.usememos.com/docs/advanced-settings/sso", target: "_blank", children: t("setting.sso-section.single-sign-on") }) }) })
    ] }),
    /* @__PURE__ */ jsxRuntimeExports.jsx(
      CreateIdentityProviderDialog,
      {
        open: isCreateDialogOpen,
        onOpenChange: setIsCreateDialogOpen,
        identityProvider: editingIdentityProvider,
        onSuccess: handleDialogSuccess
      }
    )
  ] });
};
const SectionMenuItem = ({ text, icon: IconComponent, isSelected, onClick }) => {
  return /* @__PURE__ */ jsxRuntimeExports.jsxs(
    "div",
    {
      onClick,
      className: `w-auto max-w-full px-3 leading-8 flex flex-row justify-start items-center cursor-pointer rounded-lg select-none hover:opacity-80 ${isSelected ? "bg-accent shadow" : ""}`,
      children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx(IconComponent, { className: "w-4 h-auto mr-2 opacity-80 shrink-0" }),
        /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "truncate", children: text })
      ]
    }
  );
};
const StorageSection = observer(() => {
  const t = useTranslate();
  const [workspaceStorageSetting, setWorkspaceStorageSetting] = reactExports.useState(
    WorkspaceSetting_StorageSetting.fromPartial(
      workspaceStore.getWorkspaceSettingByKey(WorkspaceSetting_Key.STORAGE)?.storageSetting || {}
    )
  );
  reactExports.useEffect(() => {
    setWorkspaceStorageSetting(
      WorkspaceSetting_StorageSetting.fromPartial(
        workspaceStore.getWorkspaceSettingByKey(WorkspaceSetting_Key.STORAGE)?.storageSetting || {}
      )
    );
  }, [workspaceStore.getWorkspaceSettingByKey(WorkspaceSetting_Key.STORAGE)]);
  const allowSaveStorageSetting = reactExports.useMemo(() => {
    if (workspaceStorageSetting.uploadSizeLimitMb <= 0) {
      return false;
    }
    const origin = WorkspaceSetting_StorageSetting.fromPartial(
      workspaceStore.getWorkspaceSettingByKey(WorkspaceSetting_Key.STORAGE)?.storageSetting || {}
    );
    if (workspaceStorageSetting.storageType === WorkspaceSetting_StorageSetting_StorageType.LOCAL) {
      if (workspaceStorageSetting.filepathTemplate.length === 0) {
        return false;
      }
    } else if (workspaceStorageSetting.storageType === WorkspaceSetting_StorageSetting_StorageType.S3) {
      if (workspaceStorageSetting.s3Config?.accessKeyId.length === 0 || workspaceStorageSetting.s3Config?.accessKeySecret.length === 0 || workspaceStorageSetting.s3Config?.endpoint.length === 0 || workspaceStorageSetting.s3Config?.region.length === 0 || workspaceStorageSetting.s3Config?.bucket.length === 0) {
        return false;
      }
    }
    return !isEqual(origin, workspaceStorageSetting);
  }, [workspaceStorageSetting, workspaceStore.state]);
  const handleMaxUploadSizeChanged = async (event) => {
    let num = parseInt(event.target.value);
    if (Number.isNaN(num)) {
      num = 0;
    }
    const update = {
      ...workspaceStorageSetting,
      uploadSizeLimitMb: num
    };
    setWorkspaceStorageSetting(update);
  };
  const handleFilepathTemplateChanged = async (event) => {
    const update = {
      ...workspaceStorageSetting,
      filepathTemplate: event.target.value
    };
    setWorkspaceStorageSetting(update);
  };
  const handlePartialS3ConfigChanged = async (s3Config) => {
    const update = {
      ...workspaceStorageSetting,
      s3Config: WorkspaceSetting_StorageSetting_S3Config.fromPartial({
        ...workspaceStorageSetting.s3Config,
        ...s3Config
      })
    };
    setWorkspaceStorageSetting(update);
  };
  const handleS3ConfigAccessKeyIdChanged = async (event) => {
    handlePartialS3ConfigChanged({ accessKeyId: event.target.value });
  };
  const handleS3ConfigAccessKeySecretChanged = async (event) => {
    handlePartialS3ConfigChanged({ accessKeySecret: event.target.value });
  };
  const handleS3ConfigEndpointChanged = async (event) => {
    handlePartialS3ConfigChanged({ endpoint: event.target.value });
  };
  const handleS3ConfigRegionChanged = async (event) => {
    handlePartialS3ConfigChanged({ region: event.target.value });
  };
  const handleS3ConfigBucketChanged = async (event) => {
    handlePartialS3ConfigChanged({ bucket: event.target.value });
  };
  const handleS3ConfigUsePathStyleChanged = (event) => {
    handlePartialS3ConfigChanged({
      usePathStyle: event.target.checked
    });
  };
  const handleStorageTypeChanged = async (storageType) => {
    const update = {
      ...workspaceStorageSetting,
      storageType
    };
    setWorkspaceStorageSetting(update);
  };
  const saveWorkspaceStorageSetting = async () => {
    await workspaceStore.upsertWorkspaceSetting({
      name: `${workspaceSettingNamePrefix}${WorkspaceSetting_Key.STORAGE}`,
      storageSetting: workspaceStorageSetting
    });
    c.success("Updated");
  };
  return /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "w-full flex flex-col gap-2 pt-2 pb-4", children: [
    /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "font-medium text-muted-foreground", children: t("setting.storage-section.current-storage") }),
    /* @__PURE__ */ jsxRuntimeExports.jsxs(
      RadioGroup,
      {
        value: workspaceStorageSetting.storageType,
        onValueChange: (value) => {
          handleStorageTypeChanged(value);
        },
        className: "flex flex-row gap-4",
        children: [
          /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center space-x-2", children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx(RadioGroupItem, { value: WorkspaceSetting_StorageSetting_StorageType.DATABASE, id: "database" }),
            /* @__PURE__ */ jsxRuntimeExports.jsx(Label, { htmlFor: "database", children: t("setting.storage-section.type-database") })
          ] }),
          /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center space-x-2", children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx(RadioGroupItem, { value: WorkspaceSetting_StorageSetting_StorageType.LOCAL, id: "local" }),
            /* @__PURE__ */ jsxRuntimeExports.jsx(Label, { htmlFor: "local", children: t("setting.storage-section.type-local") })
          ] }),
          /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center space-x-2", children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx(RadioGroupItem, { value: WorkspaceSetting_StorageSetting_StorageType.S3, id: "s3" }),
            /* @__PURE__ */ jsxRuntimeExports.jsx(Label, { htmlFor: "s3", children: "S3" })
          ] })
        ]
      }
    ),
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "w-full flex flex-row justify-between items-center", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex flex-row items-center", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-muted-foreground mr-1", children: t("setting.system-section.max-upload-size") }),
        /* @__PURE__ */ jsxRuntimeExports.jsx(TooltipProvider, { children: /* @__PURE__ */ jsxRuntimeExports.jsxs(Tooltip, { children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx(TooltipTrigger, { children: /* @__PURE__ */ jsxRuntimeExports.jsx(CircleHelp, { className: "w-4 h-auto" }) }),
          /* @__PURE__ */ jsxRuntimeExports.jsx(TooltipContent, { children: /* @__PURE__ */ jsxRuntimeExports.jsx("p", { children: t("setting.system-section.max-upload-size-hint") }) })
        ] }) })
      ] }),
      /* @__PURE__ */ jsxRuntimeExports.jsx(Input, { className: "w-16 font-mono", value: workspaceStorageSetting.uploadSizeLimitMb, onChange: handleMaxUploadSizeChanged })
    ] }),
    workspaceStorageSetting.storageType !== WorkspaceSetting_StorageSetting_StorageType.DATABASE && /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "w-full flex flex-row justify-between items-center", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-muted-foreground mr-1", children: t("setting.storage-section.filepath-template") }),
      /* @__PURE__ */ jsxRuntimeExports.jsx(
        Input,
        {
          className: "w-64",
          value: workspaceStorageSetting.filepathTemplate,
          placeholder: "assets/{timestamp}_{filename}",
          onChange: handleFilepathTemplateChanged
        }
      )
    ] }),
    workspaceStorageSetting.storageType === WorkspaceSetting_StorageSetting_StorageType.S3 && /* @__PURE__ */ jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment, { children: [
      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "w-full flex flex-row justify-between items-center", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-muted-foreground mr-1", children: "Access key id" }),
        /* @__PURE__ */ jsxRuntimeExports.jsx(
          Input,
          {
            className: "w-64",
            value: workspaceStorageSetting.s3Config?.accessKeyId,
            placeholder: "",
            onChange: handleS3ConfigAccessKeyIdChanged
          }
        )
      ] }),
      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "w-full flex flex-row justify-between items-center", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-muted-foreground mr-1", children: "Access key secret" }),
        /* @__PURE__ */ jsxRuntimeExports.jsx(
          Input,
          {
            className: "w-64",
            value: workspaceStorageSetting.s3Config?.accessKeySecret,
            placeholder: "",
            onChange: handleS3ConfigAccessKeySecretChanged
          }
        )
      ] }),
      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "w-full flex flex-row justify-between items-center", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-muted-foreground mr-1", children: "Endpoint" }),
        /* @__PURE__ */ jsxRuntimeExports.jsx(
          Input,
          {
            className: "w-64",
            value: workspaceStorageSetting.s3Config?.endpoint,
            placeholder: "",
            onChange: handleS3ConfigEndpointChanged
          }
        )
      ] }),
      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "w-full flex flex-row justify-between items-center", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-muted-foreground mr-1", children: "Region" }),
        /* @__PURE__ */ jsxRuntimeExports.jsx(
          Input,
          {
            className: "w-64",
            value: workspaceStorageSetting.s3Config?.region,
            placeholder: "",
            onChange: handleS3ConfigRegionChanged
          }
        )
      ] }),
      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "w-full flex flex-row justify-between items-center", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-muted-foreground mr-1", children: "Bucket" }),
        /* @__PURE__ */ jsxRuntimeExports.jsx(
          Input,
          {
            className: "w-64",
            value: workspaceStorageSetting.s3Config?.bucket,
            placeholder: "",
            onChange: handleS3ConfigBucketChanged
          }
        )
      ] }),
      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "w-full flex flex-row justify-between items-center", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-muted-foreground mr-1", children: "Use Path Style" }),
        /* @__PURE__ */ jsxRuntimeExports.jsx(
          Switch,
          {
            checked: workspaceStorageSetting.s3Config?.usePathStyle,
            onCheckedChange: (checked) => handleS3ConfigUsePathStyleChanged({ target: { checked } })
          }
        )
      ] })
    ] }),
    /* @__PURE__ */ jsxRuntimeExports.jsx("div", { children: /* @__PURE__ */ jsxRuntimeExports.jsx(Button, { disabled: !allowSaveStorageSetting, onClick: saveWorkspaceStorageSetting, children: t("common.save") }) }),
    /* @__PURE__ */ jsxRuntimeExports.jsx(Separator, { className: "my-2" }),
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "w-full mt-4", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsxs("p", { className: "text-sm", children: [
        t("common.learn-more"),
        ":"
      ] }),
      /* @__PURE__ */ jsxRuntimeExports.jsxs("ul", { className: "text-sm list-disc ml-4 space-y-1", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx("li", { children: /* @__PURE__ */ jsxRuntimeExports.jsx(
          Link,
          {
            className: "text-sm text-primary hover:underline",
            to: "https://www.usememos.com/docs/advanced-settings/local-storage",
            target: "_blank",
            children: "Docs - Local storage"
          }
        ) }),
        /* @__PURE__ */ jsxRuntimeExports.jsx("li", { children: /* @__PURE__ */ jsxRuntimeExports.jsx(
          Link,
          {
            className: "text-sm text-primary hover:underline",
            to: "https://www.usememos.com/blog/choosing-a-storage-for-your-resource",
            target: "_blank",
            children: "Choosing a Storage for Your Resource: Database, S3 or Local Storage?"
          }
        ) })
      ] })
    ] })
  ] });
});
function UpdateCustomizedProfileDialog({ open, onOpenChange, onSuccess }) {
  const t = useTranslate();
  const workspaceGeneralSetting = workspaceStore.state.generalSetting;
  const [customProfile, setCustomProfile] = reactExports.useState(
    WorkspaceSetting_GeneralSetting_CustomProfile.fromPartial(workspaceGeneralSetting.customProfile || {})
  );
  const [isLoading, setIsLoading] = reactExports.useState(false);
  const setPartialState = (partialState) => {
    setCustomProfile((state) => ({
      ...state,
      ...partialState
    }));
  };
  const handleNameChanged = (e) => {
    setPartialState({
      title: e.target.value
    });
  };
  const handleLogoUrlChanged = (e) => {
    setPartialState({
      logoUrl: e.target.value
    });
  };
  const handleDescriptionChanged = (e) => {
    setPartialState({
      description: e.target.value
    });
  };
  const handleLocaleSelectChange = (locale) => {
    setPartialState({
      locale
    });
  };
  const handleAppearanceSelectChange = (appearance) => {
    setPartialState({
      appearance
    });
  };
  const handleRestoreButtonClick = () => {
    setPartialState({
      title: "Memos",
      logoUrl: "/logo.webp",
      description: "",
      locale: "en",
      appearance: "system"
    });
  };
  const handleCloseButtonClick = () => {
    onOpenChange(false);
  };
  const handleSaveButtonClick = async () => {
    if (customProfile.title === "") {
      c.error("Title cannot be empty.");
      return;
    }
    setIsLoading(true);
    try {
      await workspaceStore.upsertWorkspaceSetting({
        name: `${workspaceSettingNamePrefix}${WorkspaceSetting_Key.GENERAL}`,
        generalSetting: {
          ...workspaceGeneralSetting,
          customProfile
        }
      });
      c.success(t("message.update-succeed"));
      onSuccess?.();
      onOpenChange(false);
    } catch (error) {
      console.error(error);
      c.error("Failed to update profile");
    } finally {
      setIsLoading(false);
    }
  };
  return /* @__PURE__ */ jsxRuntimeExports.jsx(Dialog, { open, onOpenChange, children: /* @__PURE__ */ jsxRuntimeExports.jsxs(DialogContent, { className: "max-w-2xl", children: [
    /* @__PURE__ */ jsxRuntimeExports.jsxs(DialogHeader, { children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx(DialogTitle, { children: t("setting.system-section.customize-server.title") }),
      /* @__PURE__ */ jsxRuntimeExports.jsx(DialogDescription, { children: "Customize your workspace appearance and settings." })
    ] }),
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "grid gap-4", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "grid gap-2", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx(Label, { htmlFor: "server-name", children: t("setting.system-section.server-name") }),
        /* @__PURE__ */ jsxRuntimeExports.jsx(Input, { id: "server-name", type: "text", value: customProfile.title, onChange: handleNameChanged, placeholder: "Enter server name" })
      ] }),
      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "grid gap-2", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx(Label, { htmlFor: "icon-url", children: t("setting.system-section.customize-server.icon-url") }),
        /* @__PURE__ */ jsxRuntimeExports.jsx(Input, { id: "icon-url", type: "text", value: customProfile.logoUrl, onChange: handleLogoUrlChanged, placeholder: "Enter icon URL" })
      ] }),
      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "grid gap-2", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx(Label, { htmlFor: "description", children: t("setting.system-section.customize-server.description") }),
        /* @__PURE__ */ jsxRuntimeExports.jsx(
          Textarea,
          {
            id: "description",
            rows: 3,
            value: customProfile.description,
            onChange: handleDescriptionChanged,
            placeholder: "Enter description"
          }
        )
      ] }),
      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "grid gap-2", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx(Label, { children: t("setting.system-section.customize-server.locale") }),
        /* @__PURE__ */ jsxRuntimeExports.jsx(LocaleSelect, { value: customProfile.locale, onChange: handleLocaleSelectChange })
      ] }),
      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "grid gap-2", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx(Label, { children: t("setting.system-section.customize-server.appearance") }),
        /* @__PURE__ */ jsxRuntimeExports.jsx(AppearanceSelect, { value: customProfile.appearance, onChange: handleAppearanceSelectChange })
      ] })
    ] }),
    /* @__PURE__ */ jsxRuntimeExports.jsxs(DialogFooter, { className: "flex-col sm:flex-row sm:justify-between gap-2", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx(Button, { variant: "outline", onClick: handleRestoreButtonClick, disabled: isLoading, className: "sm:mr-auto", children: t("common.restore") }),
      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex gap-2 w-full sm:w-auto", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx(Button, { variant: "ghost", onClick: handleCloseButtonClick, disabled: isLoading, className: "flex-1 sm:flex-initial", children: t("common.cancel") }),
        /* @__PURE__ */ jsxRuntimeExports.jsx(Button, { onClick: handleSaveButtonClick, disabled: isLoading, className: "flex-1 sm:flex-initial", children: isLoading ? "Saving..." : t("common.save") })
      ] })
    ] })
  ] }) });
}
const WorkspaceSection = observer(() => {
  const t = useTranslate();
  const customizeDialog = useDialog();
  const originalSetting = WorkspaceSetting_GeneralSetting.fromPartial(
    workspaceStore.getWorkspaceSettingByKey(WorkspaceSetting_Key.GENERAL)?.generalSetting || {}
  );
  const [workspaceGeneralSetting, setWorkspaceGeneralSetting] = reactExports.useState(originalSetting);
  const [identityProviderList, setIdentityProviderList] = reactExports.useState([]);
  reactExports.useEffect(() => {
    setWorkspaceGeneralSetting({ ...workspaceGeneralSetting, customProfile: originalSetting.customProfile });
  }, [workspaceStore.getWorkspaceSettingByKey(WorkspaceSetting_Key.GENERAL)]);
  const handleUpdateCustomizedProfileButtonClick = () => {
    customizeDialog.open();
  };
  const updatePartialSetting = (partial) => {
    setWorkspaceGeneralSetting(
      WorkspaceSetting_GeneralSetting.fromPartial({
        ...workspaceGeneralSetting,
        ...partial
      })
    );
  };
  const handleSaveGeneralSetting = async () => {
    try {
      await workspaceStore.upsertWorkspaceSetting({
        name: `${workspaceSettingNamePrefix}${WorkspaceSetting_Key.GENERAL}`,
        generalSetting: workspaceGeneralSetting
      });
    } catch (error) {
      c.error(error.details);
      console.error(error);
      return;
    }
    c.success(t("message.update-succeed"));
  };
  reactExports.useEffect(() => {
    fetchIdentityProviderList();
  }, []);
  const fetchIdentityProviderList = async () => {
    const { identityProviders } = await identityProviderServiceClient.listIdentityProviders({});
    setIdentityProviderList(identityProviders);
  };
  return /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "w-full flex flex-col gap-2 pt-2 pb-4", children: [
    /* @__PURE__ */ jsxRuntimeExports.jsx("p", { className: "font-medium text-foreground", children: t("common.basic") }),
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "w-full flex flex-row justify-between items-center", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { children: [
        t("setting.system-section.server-name"),
        ":",
        " ",
        /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "font-mono font-bold", children: workspaceGeneralSetting.customProfile?.title || "Memos" })
      ] }),
      /* @__PURE__ */ jsxRuntimeExports.jsx(Button, { variant: "outline", onClick: handleUpdateCustomizedProfileButtonClick, children: t("common.edit") })
    ] }),
    /* @__PURE__ */ jsxRuntimeExports.jsx(Separator, {}),
    /* @__PURE__ */ jsxRuntimeExports.jsx("p", { className: "font-medium text-foreground", children: t("setting.system-section.title") }),
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "w-full flex flex-row justify-between items-center", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx("span", { children: "Theme" }),
      /* @__PURE__ */ jsxRuntimeExports.jsx(
        ThemeSelector,
        {
          value: workspaceGeneralSetting.theme || "default",
          onValueChange: (value) => updatePartialSetting({ theme: value }),
          className: "min-w-fit"
        }
      )
    ] }),
    /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "w-full flex flex-row justify-between items-center", children: /* @__PURE__ */ jsxRuntimeExports.jsx("span", { children: t("setting.system-section.additional-style") }) }),
    /* @__PURE__ */ jsxRuntimeExports.jsx(
      Textarea,
      {
        className: "font-mono w-full",
        rows: 3,
        placeholder: t("setting.system-section.additional-style-placeholder"),
        value: workspaceGeneralSetting.additionalStyle,
        onChange: (event) => updatePartialSetting({ additionalStyle: event.target.value })
      }
    ),
    /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "w-full flex flex-row justify-between items-center", children: /* @__PURE__ */ jsxRuntimeExports.jsx("span", { children: t("setting.system-section.additional-script") }) }),
    /* @__PURE__ */ jsxRuntimeExports.jsx(
      Textarea,
      {
        className: "font-mono w-full",
        rows: 3,
        placeholder: t("setting.system-section.additional-script-placeholder"),
        value: workspaceGeneralSetting.additionalScript,
        onChange: (event) => updatePartialSetting({ additionalScript: event.target.value })
      }
    ),
    /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "w-full", children: /* @__PURE__ */ jsxRuntimeExports.jsxs(
      Link,
      {
        className: "text-muted-foreground text-sm flex flex-row justify-start items-center hover:underline hover:text-primary",
        to: "https://usememos.com/docs/advanced-settings/custom-style-and-script",
        target: "_blank",
        children: [
          t("common.learn-more"),
          /* @__PURE__ */ jsxRuntimeExports.jsx(ExternalLink, { className: "inline w-4 h-auto ml-1" })
        ]
      }
    ) }),
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "w-full flex flex-row justify-between items-center", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx("span", { children: t("setting.workspace-section.disallow-user-registration") }),
      /* @__PURE__ */ jsxRuntimeExports.jsx(
        Switch,
        {
          disabled: workspaceStore.state.profile.mode === "demo",
          checked: workspaceGeneralSetting.disallowUserRegistration,
          onCheckedChange: (checked) => updatePartialSetting({ disallowUserRegistration: checked })
        }
      )
    ] }),
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "w-full flex flex-row justify-between items-center", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx("span", { children: t("setting.workspace-section.disallow-password-auth") }),
      /* @__PURE__ */ jsxRuntimeExports.jsx(
        Switch,
        {
          disabled: workspaceStore.state.profile.mode === "demo" || identityProviderList.length === 0 && !workspaceGeneralSetting.disallowPasswordAuth,
          checked: workspaceGeneralSetting.disallowPasswordAuth,
          onCheckedChange: (checked) => updatePartialSetting({ disallowPasswordAuth: checked })
        }
      )
    ] }),
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "w-full flex flex-row justify-between items-center", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx("span", { children: t("setting.workspace-section.disallow-change-username") }),
      /* @__PURE__ */ jsxRuntimeExports.jsx(
        Switch,
        {
          checked: workspaceGeneralSetting.disallowChangeUsername,
          onCheckedChange: (checked) => updatePartialSetting({ disallowChangeUsername: checked })
        }
      )
    ] }),
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "w-full flex flex-row justify-between items-center", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx("span", { children: t("setting.workspace-section.disallow-change-nickname") }),
      /* @__PURE__ */ jsxRuntimeExports.jsx(
        Switch,
        {
          checked: workspaceGeneralSetting.disallowChangeNickname,
          onCheckedChange: (checked) => updatePartialSetting({ disallowChangeNickname: checked })
        }
      )
    ] }),
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "w-full flex flex-row justify-between items-center", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "truncate", children: t("setting.workspace-section.week-start-day") }),
      /* @__PURE__ */ jsxRuntimeExports.jsxs(
        Select,
        {
          value: workspaceGeneralSetting.weekStartDayOffset.toString(),
          onValueChange: (value) => {
            updatePartialSetting({ weekStartDayOffset: parseInt(value) || 0 });
          },
          children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx(SelectTrigger, { className: "min-w-fit", children: /* @__PURE__ */ jsxRuntimeExports.jsx(SelectValue, {}) }),
            /* @__PURE__ */ jsxRuntimeExports.jsxs(SelectContent, { children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx(SelectItem, { value: "-1", children: t("setting.workspace-section.saturday") }),
              /* @__PURE__ */ jsxRuntimeExports.jsx(SelectItem, { value: "0", children: t("setting.workspace-section.sunday") }),
              /* @__PURE__ */ jsxRuntimeExports.jsx(SelectItem, { value: "1", children: t("setting.workspace-section.monday") })
            ] })
          ]
        }
      )
    ] }),
    /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "mt-2 w-full flex justify-end", children: /* @__PURE__ */ jsxRuntimeExports.jsx(Button, { disabled: isEqual(workspaceGeneralSetting, originalSetting), onClick: handleSaveGeneralSetting, children: t("common.save") }) }),
    /* @__PURE__ */ jsxRuntimeExports.jsx(
      UpdateCustomizedProfileDialog,
      {
        open: customizeDialog.isOpen,
        onOpenChange: customizeDialog.setOpen,
        onSuccess: () => {
          c.success("Profile updated successfully!");
        }
      }
    )
  ] });
});
const BASIC_SECTIONS = ["my-account", "preference"];
const ADMIN_SECTIONS = ["member", "system", "memo-related", "storage", "sso"];
const SECTION_ICON_MAP = {
  "my-account": User,
  preference: Cog,
  member: Users,
  system: Settings2,
  "memo-related": Library,
  storage: Database,
  sso: Key
};
const Setting = observer(() => {
  const t = useTranslate();
  const { md } = useResponsiveWidth();
  const location = useLocation();
  const user = useCurrentUser();
  const [state, setState] = reactExports.useState({
    selectedSection: "my-account"
  });
  const isHost = user.role === User_Role.HOST;
  const settingsSectionList = reactExports.useMemo(() => {
    let settingList = [...BASIC_SECTIONS];
    if (isHost) {
      settingList = settingList.concat(ADMIN_SECTIONS);
    }
    return settingList;
  }, [isHost]);
  reactExports.useEffect(() => {
    let hash = location.hash.slice(1);
    if (![...BASIC_SECTIONS, ...ADMIN_SECTIONS].includes(hash)) {
      hash = "my-account";
    }
    setState({
      selectedSection: hash
    });
  }, [location.hash]);
  reactExports.useEffect(() => {
    if (!isHost) {
      return;
    }
    (async () => {
      [WorkspaceSetting_Key.MEMO_RELATED, WorkspaceSetting_Key.STORAGE].forEach(async (key) => {
        await workspaceStore.fetchWorkspaceSetting(key);
      });
    })();
  }, [isHost]);
  const handleSectionSelectorItemClick = reactExports.useCallback((settingSection) => {
    window.location.hash = settingSection;
  }, []);
  return /* @__PURE__ */ jsxRuntimeExports.jsxs("section", { className: "@container w-full max-w-5xl min-h-full flex flex-col justify-start items-start sm:pt-3 md:pt-6 pb-8", children: [
    !md && /* @__PURE__ */ jsxRuntimeExports.jsx(MobileHeader, {}),
    /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "w-full px-4 sm:px-6", children: /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "w-full border border-border flex flex-row justify-start items-start px-4 py-3 rounded-xl bg-background text-muted-foreground", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "hidden sm:flex flex-col justify-start items-start w-40 h-auto shrink-0 py-2", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-sm mt-0.5 pl-3 font-mono select-none text-muted-foreground", children: t("common.basic") }),
        /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "w-full flex flex-col justify-start items-start mt-1", children: BASIC_SECTIONS.map((item) => /* @__PURE__ */ jsxRuntimeExports.jsx(
          SectionMenuItem,
          {
            text: t(`setting.${item}`),
            icon: SECTION_ICON_MAP[item],
            isSelected: state.selectedSection === item,
            onClick: () => handleSectionSelectorItemClick(item)
          },
          item
        )) }),
        isHost ? /* @__PURE__ */ jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment, { children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-sm mt-4 pl-3 font-mono select-none text-muted-foreground", children: t("common.admin") }),
          /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "w-full flex flex-col justify-start items-start mt-1", children: [
            ADMIN_SECTIONS.map((item) => /* @__PURE__ */ jsxRuntimeExports.jsx(
              SectionMenuItem,
              {
                text: t(`setting.${item}`),
                icon: SECTION_ICON_MAP[item],
                isSelected: state.selectedSection === item,
                onClick: () => handleSectionSelectorItemClick(item)
              },
              item
            )),
            /* @__PURE__ */ jsxRuntimeExports.jsxs("span", { className: "px-3 mt-2 opacity-70 text-sm", children: [
              t("setting.version"),
              ": v",
              workspaceStore.state.profile.version
            ] })
          ] })
        ] }) : null
      ] }),
      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "w-full grow sm:pl-4 overflow-x-auto", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "w-auto inline-block my-2 sm:hidden", children: /* @__PURE__ */ jsxRuntimeExports.jsxs(Select, { value: state.selectedSection, onValueChange: (value) => handleSectionSelectorItemClick(value), children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx(SelectTrigger, { className: "w-[180px]", children: /* @__PURE__ */ jsxRuntimeExports.jsx(SelectValue, { placeholder: "Select section" }) }),
          /* @__PURE__ */ jsxRuntimeExports.jsx(SelectContent, { children: settingsSectionList.map((settingSection) => /* @__PURE__ */ jsxRuntimeExports.jsx(SelectItem, { value: settingSection, children: t(`setting.${settingSection}`) }, settingSection)) })
        ] }) }),
        state.selectedSection === "my-account" ? /* @__PURE__ */ jsxRuntimeExports.jsx(MyAccountSection, {}) : state.selectedSection === "preference" ? /* @__PURE__ */ jsxRuntimeExports.jsx(PreferencesSection, {}) : state.selectedSection === "member" ? /* @__PURE__ */ jsxRuntimeExports.jsx(MemberSection, {}) : state.selectedSection === "system" ? /* @__PURE__ */ jsxRuntimeExports.jsx(WorkspaceSection, {}) : state.selectedSection === "memo-related" ? /* @__PURE__ */ jsxRuntimeExports.jsx(MemoRelatedSettings, {}) : state.selectedSection === "storage" ? /* @__PURE__ */ jsxRuntimeExports.jsx(StorageSection, {}) : state.selectedSection === "sso" ? /* @__PURE__ */ jsxRuntimeExports.jsx(SSOSection, {}) : null
      ] })
    ] }) })
  ] });
});
export {
  Setting as default
};
